2025-12-13 14:02:57,613 - INFO - Logging initialized. Log file: runs/run_194/training.log
2025-12-13 14:02:57,616 - INFO - Experiment directory: runs/run_194
2025-12-13 14:02:57,617 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-13 14:02:57,760 - INFO - Random seeds set to 42 (deterministic=False)
2025-12-13 14:02:57,991 - INFO - GPU memory cleared at startup. Available: 11.6GB
2025-12-13 14:02:57,993 - INFO - Using device: cuda
2025-12-13 14:02:57,994 - INFO - Training configuration: epochs=50, warmup=3, lr=0.0002
2025-12-13 14:02:57,996 - INFO - SWIN configuration: variant=tiny, use_shifted_window=True, use_relative_bias=True, use_absolute_pos_embed=False, use_hierarchical_merge=False, use_gradient_checkpointing=True
2025-12-13 14:02:57,997 - INFO - SWIN details: embed_dim=96, depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24], window_size=7
2025-12-13 14:02:57,999 - INFO - Loading dataset...
2025-12-13 14:03:02,641 - INFO - Dataset loaded: train=41667 samples (652 batches), val=8333 samples (131 batches), test=10000 samples (157 batches)
2025-12-13 14:03:06,771 - INFO - Training Swin-Tiny from scratch
2025-12-13 14:03:06,773 - INFO - Initializing model from scratch...
2025-12-13 14:03:06,775 - INFO - Model architecture: Swin-Tiny
2025-12-13 14:03:06,777 - INFO - Model config: embed_dim=96, depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24], window_size=7, use_shifted_window=True, use_relative_bias=True, use_absolute_pos_embed=False, use_hierarchical_merge=False, use_gradient_checkpointing=True
2025-12-13 14:03:07,742 - INFO - Model created with random initialization
2025-12-13 14:03:07,744 - INFO - Total parameters: 27,596,254
2025-12-13 14:03:07,746 - INFO - Trainable parameters: 27,596,254
2025-12-13 14:03:07,796 - INFO - Starting from-scratch training...
2025-12-13 14:03:07,798 - INFO - Optimizer: training all model parameters
2025-12-13 14:03:07,802 - INFO - LR Scheduler: cosine with 3 warmup epochs
2025-12-13 14:03:07,804 - INFO - Starting training...
2025-12-13 14:09:17,465 - INFO - Epoch 1/50: LR: 0.000068
2025-12-13 14:09:17,467 - INFO - Epoch 1/50: Train Loss: 4.3275, Val Loss: 4.1714, Val Acc: 7.38%
2025-12-13 14:15:21,179 - INFO - Epoch 2/50: LR: 0.000134
2025-12-13 14:15:21,182 - INFO - Epoch 2/50: Train Loss: 3.9734, Val Loss: 3.6750, Val Acc: 13.81%
2025-12-13 14:21:25,740 - INFO - Epoch 3/50: LR: 0.000200
2025-12-13 14:21:25,743 - INFO - Epoch 3/50: Train Loss: 3.5614, Val Loss: 3.3996, Val Acc: 18.18%
2025-12-13 14:27:30,890 - INFO - Epoch 4/50: LR: 0.000200
2025-12-13 14:27:30,893 - INFO - Epoch 4/50: Train Loss: 3.3255, Val Loss: 3.2556, Val Acc: 20.94%
2025-12-13 14:33:35,829 - INFO - Epoch 5/50: LR: 0.000199
2025-12-13 14:34:38,330 - INFO - Epoch 5/50: Train Loss: 3.0429, Val Loss: 3.0049, Val Acc: 25.63%, Test Loss: 2.9913, Test Acc: 25.91%
2025-12-13 14:40:44,310 - INFO - Epoch 6/50: LR: 0.000198
2025-12-13 14:40:44,312 - INFO - Epoch 6/50: Train Loss: 2.8031, Val Loss: 2.7752, Val Acc: 30.35%
2025-12-13 14:46:49,276 - INFO - Epoch 7/50: LR: 0.000197
2025-12-13 14:46:49,279 - INFO - Epoch 7/50: Train Loss: 2.6069, Val Loss: 2.6267, Val Acc: 32.79%
2025-12-13 14:52:55,846 - INFO - Epoch 8/50: LR: 0.000196
2025-12-13 14:52:55,849 - INFO - Epoch 8/50: Train Loss: 2.4271, Val Loss: 2.3469, Val Acc: 38.80%
2025-12-13 14:59:02,707 - INFO - Epoch 9/50: LR: 0.000194
2025-12-13 14:59:02,710 - INFO - Epoch 9/50: Train Loss: 2.2487, Val Loss: 2.2191, Val Acc: 41.22%
2025-12-13 15:05:08,105 - INFO - Epoch 10/50: LR: 0.000192
2025-12-13 15:06:10,297 - INFO - Epoch 10/50: Train Loss: 2.0985, Val Loss: 2.1198, Val Acc: 43.95%, Test Loss: 2.1112, Test Acc: 44.07%
2025-12-13 15:06:10,299 - INFO - Saving checkpoint for epoch 10...
2025-12-13 15:06:11,387 - INFO - ✅ Checkpoint saved: runs/run_194/checkpoint_epoch_10.pth
2025-12-13 15:12:18,778 - INFO - Epoch 11/50: LR: 0.000190
2025-12-13 15:12:18,780 - INFO - Epoch 11/50: Train Loss: 1.9577, Val Loss: 2.0872, Val Acc: 43.83%
2025-12-13 15:18:26,285 - INFO - Epoch 12/50: LR: 0.000187
2025-12-13 15:18:26,288 - INFO - Epoch 12/50: Train Loss: 1.8378, Val Loss: 1.9253, Val Acc: 47.92%
2025-12-13 15:24:34,579 - INFO - Epoch 13/50: LR: 0.000184
2025-12-13 15:24:34,582 - INFO - Epoch 13/50: Train Loss: 1.7120, Val Loss: 1.8971, Val Acc: 49.06%
2025-12-13 15:30:41,730 - INFO - Epoch 14/50: LR: 0.000181
2025-12-13 15:30:41,732 - INFO - Epoch 14/50: Train Loss: 1.6136, Val Loss: 1.8404, Val Acc: 50.32%
2025-12-13 15:36:48,146 - INFO - Epoch 15/50: LR: 0.000177
2025-12-13 15:37:50,782 - INFO - Epoch 15/50: Train Loss: 1.5179, Val Loss: 1.7950, Val Acc: 51.45%, Test Loss: 1.7567, Test Acc: 52.44%
2025-12-13 15:43:57,061 - INFO - Epoch 16/50: LR: 0.000173
2025-12-13 15:43:57,074 - INFO - Epoch 16/50: Train Loss: 1.4278, Val Loss: 1.7590, Val Acc: 52.32%
2025-12-13 15:50:02,521 - INFO - Epoch 17/50: LR: 0.000169
2025-12-13 15:50:02,523 - INFO - Epoch 17/50: Train Loss: 1.3356, Val Loss: 1.7394, Val Acc: 53.45%
2025-12-13 15:56:08,469 - INFO - Epoch 18/50: LR: 0.000165
2025-12-13 15:56:08,471 - INFO - Epoch 18/50: Train Loss: 1.2577, Val Loss: 1.6980, Val Acc: 53.99%
2025-12-13 16:02:14,122 - INFO - Epoch 19/50: LR: 0.000161
2025-12-13 16:02:14,125 - INFO - Epoch 19/50: Train Loss: 1.1580, Val Loss: 1.6933, Val Acc: 54.79%
2025-12-13 16:08:21,211 - INFO - Epoch 20/50: LR: 0.000157
2025-12-13 16:09:24,489 - INFO - Epoch 20/50: Train Loss: 1.0871, Val Loss: 1.7239, Val Acc: 54.89%, Test Loss: 1.6797, Test Acc: 55.51%
2025-12-13 16:09:24,492 - INFO - Saving checkpoint for epoch 20...
2025-12-13 16:09:25,598 - INFO - ✅ Checkpoint saved: runs/run_194/checkpoint_epoch_20.pth
2025-12-13 16:15:31,296 - INFO - Epoch 21/50: LR: 0.000152
2025-12-13 16:15:31,298 - INFO - Epoch 21/50: Train Loss: 1.0142, Val Loss: 1.6928, Val Acc: 55.55%
2025-12-13 16:21:38,163 - INFO - Epoch 22/50: LR: 0.000147
2025-12-13 16:21:38,165 - INFO - Epoch 22/50: Train Loss: 0.9266, Val Loss: 1.6835, Val Acc: 55.78%
2025-12-13 16:27:44,841 - INFO - Epoch 23/50: LR: 0.000142
2025-12-13 16:27:44,843 - INFO - Epoch 23/50: Train Loss: 0.8420, Val Loss: 1.6989, Val Acc: 55.61%
2025-12-13 16:33:51,538 - INFO - Epoch 24/50: LR: 0.000137
2025-12-13 16:33:51,540 - INFO - Epoch 24/50: Train Loss: 0.7875, Val Loss: 1.6773, Val Acc: 57.27%
2025-12-13 16:39:57,871 - INFO - Epoch 25/50: LR: 0.000133
2025-12-13 16:41:00,413 - INFO - Epoch 25/50: Train Loss: 0.7038, Val Loss: 1.7360, Val Acc: 56.10%, Test Loss: 1.6503, Test Acc: 57.96%
2025-12-13 16:47:05,090 - INFO - Epoch 26/50: LR: 0.000128
2025-12-13 16:47:05,121 - INFO - Epoch 26/50: Train Loss: 0.6523, Val Loss: 1.7618, Val Acc: 55.96%
2025-12-13 16:53:10,277 - INFO - Epoch 27/50: LR: 0.000122
2025-12-13 16:53:10,280 - INFO - Epoch 27/50: Train Loss: 0.5844, Val Loss: 1.7157, Val Acc: 57.42%
2025-12-13 16:59:18,610 - INFO - Epoch 28/50: LR: 0.000117
2025-12-13 16:59:18,613 - INFO - Epoch 28/50: Train Loss: 0.5181, Val Loss: 1.7655, Val Acc: 56.70%
2025-12-13 17:05:29,691 - INFO - Epoch 29/50: LR: 0.000113
2025-12-13 17:05:29,694 - INFO - Epoch 29/50: Train Loss: 0.4777, Val Loss: 1.8021, Val Acc: 56.93%
2025-12-13 17:11:37,939 - INFO - Epoch 30/50: LR: 0.000108
2025-12-13 17:12:40,972 - INFO - Epoch 30/50: Train Loss: 0.4357, Val Loss: 1.7728, Val Acc: 58.14%, Test Loss: 1.7165, Test Acc: 59.91%
2025-12-13 17:12:40,974 - INFO - Saving checkpoint for epoch 30...
2025-12-13 17:12:42,028 - INFO - ✅ Checkpoint saved: runs/run_194/checkpoint_epoch_30.pth
2025-12-13 17:18:50,276 - INFO - Epoch 31/50: LR: 0.000103
2025-12-13 17:18:50,279 - INFO - Epoch 31/50: Train Loss: 0.4012, Val Loss: 1.8180, Val Acc: 57.22%
2025-12-13 17:24:57,700 - INFO - Epoch 32/50: LR: 0.000098
2025-12-13 17:24:57,703 - INFO - Epoch 32/50: Train Loss: 0.3591, Val Loss: 1.8482, Val Acc: 57.85%
2025-12-13 17:31:04,980 - INFO - Epoch 33/50: LR: 0.000093
2025-12-13 17:31:05,009 - INFO - Epoch 33/50: Train Loss: 0.3237, Val Loss: 1.8178, Val Acc: 58.31%
2025-12-13 17:37:11,994 - INFO - Epoch 34/50: LR: 0.000089
2025-12-13 17:37:11,996 - INFO - Epoch 34/50: Train Loss: 0.3180, Val Loss: 1.8519, Val Acc: 58.29%
2025-12-13 17:43:20,461 - INFO - Epoch 35/50: LR: 0.000085
2025-12-13 17:44:24,237 - INFO - Epoch 35/50: Train Loss: 0.2750, Val Loss: 1.8533, Val Acc: 58.78%, Test Loss: 1.8005, Test Acc: 60.30%
2025-12-13 17:50:33,031 - INFO - Epoch 36/50: LR: 0.000081
2025-12-13 17:50:33,033 - INFO - Epoch 36/50: Train Loss: 0.2721, Val Loss: 1.8562, Val Acc: 58.90%
2025-12-13 17:56:40,716 - INFO - Epoch 37/50: LR: 0.000077
2025-12-13 17:56:40,718 - INFO - Epoch 37/50: Train Loss: 0.2410, Val Loss: 1.8800, Val Acc: 59.03%
2025-12-13 18:02:47,980 - INFO - Epoch 38/50: LR: 0.000073
2025-12-13 18:02:47,982 - INFO - Epoch 38/50: Train Loss: 0.2302, Val Loss: 1.9117, Val Acc: 58.54%
2025-12-13 18:08:57,625 - INFO - Epoch 39/50: LR: 0.000069
2025-12-13 18:08:57,627 - INFO - Epoch 39/50: Train Loss: 0.2098, Val Loss: 1.8646, Val Acc: 59.53%
2025-12-13 18:15:05,673 - INFO - Epoch 40/50: LR: 0.000066
2025-12-13 18:16:09,136 - INFO - Epoch 40/50: Train Loss: 0.1944, Val Loss: 1.9170, Val Acc: 59.05%, Test Loss: 1.8588, Test Acc: 60.65%
2025-12-13 18:16:09,139 - INFO - Saving checkpoint for epoch 40...
2025-12-13 18:16:10,257 - INFO - ✅ Checkpoint saved: runs/run_194/checkpoint_epoch_40.pth
2025-12-13 18:22:17,033 - INFO - Epoch 41/50: LR: 0.000063
2025-12-13 18:22:17,035 - INFO - Epoch 41/50: Train Loss: 0.1778, Val Loss: 1.9066, Val Acc: 58.91%
2025-12-13 18:28:25,677 - INFO - Epoch 42/50: LR: 0.000060
2025-12-13 18:28:25,680 - INFO - Epoch 42/50: Train Loss: 0.1757, Val Loss: 1.9184, Val Acc: 59.15%
2025-12-13 18:34:34,316 - INFO - Epoch 43/50: LR: 0.000058
2025-12-13 18:34:34,319 - INFO - Epoch 43/50: Train Loss: 0.1724, Val Loss: 1.9272, Val Acc: 59.57%
2025-12-13 18:40:41,968 - INFO - Epoch 44/50: LR: 0.000056
2025-12-13 18:40:41,970 - INFO - Epoch 44/50: Train Loss: 0.1716, Val Loss: 1.9641, Val Acc: 58.92%
2025-12-13 18:46:49,824 - INFO - Epoch 45/50: LR: 0.000054
2025-12-13 18:47:53,603 - INFO - Epoch 45/50: Train Loss: 0.1523, Val Loss: 1.9715, Val Acc: 58.95%, Test Loss: 1.8845, Test Acc: 60.98%
2025-12-13 18:54:01,949 - INFO - Epoch 46/50: LR: 0.000053
2025-12-13 18:54:01,951 - INFO - Epoch 46/50: Train Loss: 0.1404, Val Loss: 1.9526, Val Acc: 59.57%
2025-12-13 19:00:09,875 - INFO - Epoch 47/50: LR: 0.000052
2025-12-13 19:00:09,877 - INFO - Epoch 47/50: Train Loss: 0.1355, Val Loss: 1.9412, Val Acc: 59.77%
2025-12-13 19:06:20,297 - INFO - Epoch 48/50: LR: 0.000051
2025-12-13 19:06:20,299 - INFO - Epoch 48/50: Train Loss: 0.1312, Val Loss: 1.9899, Val Acc: 59.91%
2025-12-13 19:12:28,747 - INFO - Epoch 49/50: LR: 0.000050
2025-12-13 19:12:28,750 - INFO - Epoch 49/50: Train Loss: 0.1279, Val Loss: 1.9606, Val Acc: 60.54%
2025-12-13 19:18:35,929 - INFO - Epoch 50/50: LR: 0.000050
2025-12-13 19:19:39,060 - INFO - Epoch 50/50: Train Loss: 0.1289, Val Loss: 2.0006, Val Acc: 59.64%, Test Loss: 1.9458, Test Acc: 61.13%
2025-12-13 19:19:39,063 - INFO - Saving checkpoint for epoch 50...
2025-12-13 19:19:40,203 - INFO - ✅ Checkpoint saved: runs/run_194/checkpoint_epoch_50.pth
2025-12-13 19:19:40,205 - INFO - Training completed!
2025-12-13 19:19:40,208 - INFO - Training completed!
2025-12-13 19:19:40,209 - INFO - Generating training curves...
2025-12-13 19:19:43,278 - INFO - Too many classes (100) for per-class plotting, skipping
2025-12-13 19:19:43,280 - INFO - Training curves saved as separate images with base name 'runs/run_194/training_curves_from_scratch'
2025-12-13 19:19:43,281 - INFO - Generating confusion matrix on test set...
2025-12-13 19:21:19,205 - INFO - Performing final evaluation of from_scratch model on test set...
2025-12-13 19:22:22,376 - INFO - Final Test Results of from_scratch model: Loss: 1.9458, Accuracy: 61.13%
2025-12-13 19:22:22,378 - INFO - Generating LR schedule plot of from_scratch model...
2025-12-13 19:22:23,164 - INFO - LR schedule plot saved to 'runs/run_194/lr_schedule_from_scratch.png'
2025-12-13 19:22:23,166 - INFO - 
Final Test Results:
2025-12-13 19:22:23,167 - INFO - Loss: 1.9458
2025-12-13 19:22:23,169 - INFO - Accuracy: 61.13%
2025-12-13 19:22:23,170 - INFO - Precision: 61.91%
2025-12-13 19:22:23,172 - INFO - Recall: 61.13%
2025-12-13 19:22:23,173 - INFO - F1 Score: 61.01%
2025-12-13 19:22:23,293 - INFO - Experiment completed. Results saved to runs/run_194/results_from_scratch.json
2025-12-13 19:22:23,297 - INFO - Experiment completed. Metadata saved to runs/run_194/metadata_from_scratch.json
2025-12-13 19:22:23,669 - INFO - ✅ Model weights saved: runs/run_194/final_model_from_scratch_weights.pth
2025-12-13 19:22:23,674 - INFO - Final model saved: runs/run_194/final_model_from_scratch_weights.pth
2025-12-13 19:22:23,676 - INFO - Final model metadata saved: runs/run_194/final_model_from_scratch_metadata.json
2025-12-13 19:22:23,677 - INFO - === FROM-SCRATCH RESULTS (CIFAR100) ===
2025-12-13 19:22:23,679 - INFO - Final Accuracy: 61.13%
2025-12-13 19:22:23,680 - INFO - Final F1 Score: 61.01%
2025-12-13 19:22:23,687 - INFO - from_scratch experiment completed successfully!
