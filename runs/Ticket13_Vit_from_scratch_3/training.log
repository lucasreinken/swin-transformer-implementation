2025-12-17 12:42:27,314 - INFO - Logging initialized. Log file: runs/run_223/training.log
2025-12-17 12:42:27,347 - INFO - Experiment directory: runs/run_223
2025-12-17 12:42:27,349 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-17 12:42:27,454 - INFO - ✅ All seeds set to 42 (deterministic=False)
2025-12-17 12:42:27,901 - INFO - GPU memory cleared at startup. Available: 23.6GB
2025-12-17 12:42:27,904 - INFO - Using device: cuda
2025-12-17 12:42:27,906 - INFO - Training configuration: epochs=15, warmup=1, lr=0.0015
2025-12-17 12:42:27,907 - INFO - VIT configuration: {'type': 'vit', 'img_size': 224, 'patch_size': 16, 'embed_dim': 448, 'depth': 12, 'num_heads': 7, 'mlp_ratio': 4.0, 'num_classes': 1000, 'use_gradient_checkpointing': True}
2025-12-17 12:42:27,909 - INFO - Loading dataset...
2025-12-17 12:42:27,913 - INFO - Starting ImageNet data loading from root: /
2025-12-17 12:42:27,915 - INFO - Resolved root path: /
2025-12-17 12:42:27,917 - INFO - Root path exists: True
2025-12-17 12:42:27,919 - INFO - Root path is dir: True
2025-12-17 12:42:27,931 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var', '/meta', '/train_set', '/train_set_small', '/val_set', '/val_set_unlabeled']
2025-12-17 12:42:27,933 - INFO - Expected train_dir: /train_set, exists: True
2025-12-17 12:42:27,936 - INFO - Expected val_dir: /val_set, exists: True
2025-12-17 12:42:42,277 - INFO - Loaded ImageNet data from /: train=1281167, val=50000
2025-12-17 12:42:42,623 - INFO - Dataset loaded: train=100000 samples (782 batches), val=50000 samples (391 batches), test=50000 samples (391 batches)
2025-12-17 12:42:47,711 - INFO - Training VIT from scratch
2025-12-17 12:42:47,740 - INFO - Initializing VIT model from scratch...
2025-12-17 12:42:47,743 - INFO - Model architecture: VIT
2025-12-17 12:42:47,745 - INFO - Model config: {'type': 'vit', 'img_size': 224, 'patch_size': 16, 'embed_dim': 448, 'depth': 12, 'num_heads': 7, 'mlp_ratio': 4.0, 'num_classes': 1000, 'use_gradient_checkpointing': True}
2025-12-17 12:42:49,068 - INFO - Model created with random initialization
2025-12-17 12:42:49,070 - INFO - Total parameters: 29,854,376
2025-12-17 12:42:49,071 - INFO - Trainable parameters: 29,854,376
2025-12-17 12:42:49,160 - INFO - Starting from-scratch training...
2025-12-17 12:42:49,162 - INFO - Optimizer: training all model parameters
2025-12-17 12:42:49,166 - INFO - LR Scheduler: cosine with 1 warmup epochs
2025-12-17 12:42:49,168 - INFO - Starting training...
2025-12-17 13:33:49,858 - INFO - Epoch 1/15: LR: 0.001500
2025-12-17 13:33:49,860 - INFO - Epoch 1/15: Train Loss: 6.8510, Val Loss: 6.7194, Val Acc: 0.79%
2025-12-17 14:17:04,274 - INFO - Epoch 2/15: LR: 0.001482
2025-12-17 14:17:04,276 - INFO - Epoch 2/15: Train Loss: 6.8992, Val Loss: 6.8106, Val Acc: 0.30%
2025-12-17 15:01:35,185 - INFO - Epoch 3/15: LR: 0.001431
2025-12-17 15:01:35,217 - INFO - Epoch 3/15: Train Loss: 6.7979, Val Loss: 6.7632, Val Acc: 0.45%
2025-12-17 15:44:34,185 - INFO - Epoch 4/15: LR: 0.001347
2025-12-17 15:44:34,187 - INFO - Epoch 4/15: Train Loss: 6.7924, Val Loss: 6.6657, Val Acc: 0.61%
2025-12-17 16:28:40,298 - INFO - Epoch 5/15: LR: 0.001236
2025-12-17 16:42:42,883 - INFO - Epoch 5/15: Train Loss: 6.8119, Val Loss: 6.7842, Val Acc: 0.39%, Test Loss: 6.7842, Test Acc: 0.39%
2025-12-17 17:26:36,774 - INFO - Epoch 6/15: LR: 0.001104
2025-12-17 17:26:36,812 - INFO - Epoch 6/15: Train Loss: 6.8062, Val Loss: 6.7172, Val Acc: 0.42%
2025-12-17 18:11:18,219 - INFO - Epoch 7/15: LR: 0.000956
2025-12-17 18:11:18,273 - INFO - Epoch 7/15: Train Loss: 6.7802, Val Loss: 6.7465, Val Acc: 0.49%
2025-12-17 18:54:38,093 - INFO - Epoch 8/15: LR: 0.000800
2025-12-17 18:54:38,104 - INFO - Epoch 8/15: Train Loss: 6.8136, Val Loss: 6.8059, Val Acc: 0.37%
2025-12-17 19:36:50,467 - INFO - Epoch 9/15: LR: 0.000644
2025-12-17 19:36:50,474 - INFO - Epoch 9/15: Train Loss: 6.7932, Val Loss: 6.7130, Val Acc: 0.48%
2025-12-17 20:20:26,265 - INFO - Epoch 10/15: LR: 0.000496
2025-12-17 20:34:32,461 - INFO - Epoch 10/15: Train Loss: 6.7495, Val Loss: 6.6717, Val Acc: 0.67%, Test Loss: 6.6717, Test Acc: 0.67%
2025-12-17 20:34:32,464 - INFO - Saving checkpoint for epoch 10...
2025-12-17 20:34:34,161 - INFO - ✅ Checkpoint saved: runs/run_223/checkpoint_epoch_10.pth
2025-12-17 21:16:46,485 - INFO - Epoch 11/15: LR: 0.000364
2025-12-17 21:16:46,493 - INFO - Epoch 11/15: Train Loss: 6.7224, Val Loss: 6.6326, Val Acc: 0.72%
2025-12-17 21:59:13,629 - INFO - Epoch 12/15: LR: 0.000253
2025-12-17 21:59:13,631 - INFO - Epoch 12/15: Train Loss: 6.7013, Val Loss: 6.6270, Val Acc: 0.82%
2025-12-17 22:42:43,688 - INFO - Epoch 13/15: LR: 0.000169
2025-12-17 22:42:43,726 - INFO - Epoch 13/15: Train Loss: 6.6839, Val Loss: 6.5991, Val Acc: 0.91%
2025-12-17 23:27:51,850 - INFO - Epoch 14/15: LR: 0.000118
2025-12-17 23:27:52,414 - INFO - Epoch 14/15: Train Loss: 6.6663, Val Loss: 6.5660, Val Acc: 1.02%
2025-12-18 00:14:28,097 - INFO - Epoch 15/15: LR: 0.000100
2025-12-18 00:28:33,126 - INFO - Epoch 15/15: Train Loss: 6.6569, Val Loss: 6.5548, Val Acc: 1.04%, Test Loss: 6.5548, Test Acc: 1.04%
2025-12-18 00:28:33,264 - INFO - Training completed!
2025-12-18 00:28:33,273 - INFO - Training completed!
2025-12-18 00:28:33,274 - INFO - Generating training curves...
2025-12-18 00:28:38,087 - INFO - Too many classes (1000) for per-class plotting, skipping
2025-12-18 00:28:38,089 - INFO - Training curves saved as separate images with base name 'runs/run_223/training_curves_from_scratch'
2025-12-18 00:28:38,090 - INFO - Generating confusion matrix on test set...
2025-12-18 01:32:25,320 - INFO - Performing final evaluation of from_scratch model on test set...
2025-12-18 01:48:18,183 - INFO - Final Test Results of from_scratch model: Loss: 6.5548, Accuracy: 1.04%
2025-12-18 01:48:18,221 - INFO - Generating LR schedule plot of from_scratch model...
2025-12-18 01:48:18,972 - INFO - LR schedule plot saved to 'runs/run_223/lr_schedule_from_scratch.png'
2025-12-18 01:48:18,974 - INFO - 
Final Test Results:
2025-12-18 01:48:18,976 - INFO - Loss: 6.5548
2025-12-18 01:48:18,977 - INFO - Accuracy: 1.04%
2025-12-18 01:48:18,979 - INFO - Precision: 0.34%
2025-12-18 01:48:18,981 - INFO - Recall: 1.04%
2025-12-18 01:48:18,983 - INFO - F1 Score: 0.30%
2025-12-18 01:48:19,298 - INFO - Experiment completed. Results saved to runs/run_223/results_from_scratch.json
2025-12-18 01:48:19,303 - INFO - Experiment completed. Metadata saved to runs/run_223/metadata_from_scratch.json
2025-12-18 01:48:19,883 - INFO - ✅ Model weights saved: runs/run_223/final_model_from_scratch_weights.pth
2025-12-18 01:48:19,889 - INFO - Final model saved: runs/run_223/final_model_from_scratch_weights.pth
2025-12-18 01:48:19,891 - INFO - Final model metadata saved: runs/run_223/final_model_from_scratch_metadata.json
2025-12-18 01:48:19,893 - INFO - === FROM-SCRATCH RESULTS (IMAGENET) ===
2025-12-18 01:48:19,895 - INFO - Final Accuracy: 1.04%
2025-12-18 01:48:19,897 - INFO - Final F1 Score: 0.30%
2025-12-18 01:48:19,902 - INFO - from_scratch experiment completed successfully!
