2025-11-22 13:09:54,120 - INFO - Logging initialized. Log file: runs/run_42/training.log
2025-11-22 13:09:54,389 - INFO - Random seeds set to 42 (deterministic=False)
2025-11-22 13:09:54,391 - INFO - Using device: cuda
2025-11-22 13:09:56,979 - INFO - Initializing reference model...
2025-11-22 13:09:57,244 - INFO - Loading pretrained weights from Hugging Face hub (timm/resnet50.a1_in1k)
2025-11-22 13:09:57,472 - INFO - [timm/resnet50.a1_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-11-22 13:09:57,641 - INFO - Reference model created. Frozen params (encoder only): 23,508,032
2025-11-22 13:09:57,643 - INFO - Trainable params (head only): 208,996
2025-11-22 13:09:57,856 - INFO - Training reference model (HF)...
2025-11-22 13:09:57,858 - INFO - Starting training...
2025-11-22 13:11:15,483 - INFO - Epoch 1/50: LR: 0.000550
2025-11-22 13:11:15,485 - INFO - Epoch 1/50: Train Loss: 3.7961, Val Loss: 3.1322, Val Acc: 38.57%
2025-11-22 13:12:31,215 - INFO - Epoch 2/50: LR: 0.001000
2025-11-22 13:12:31,217 - INFO - Epoch 2/50: Train Loss: 2.2756, Val Loss: 1.8259, Val Acc: 52.12%
2025-11-22 13:13:46,926 - INFO - Epoch 3/50: LR: 0.000999
2025-11-22 13:13:46,928 - INFO - Epoch 3/50: Train Loss: 1.6989, Val Loss: 1.6351, Val Acc: 55.35%
2025-11-22 13:15:02,525 - INFO - Epoch 4/50: LR: 0.000996
2025-11-22 13:15:02,527 - INFO - Epoch 4/50: Train Loss: 1.4508, Val Loss: 1.6194, Val Acc: 56.40%
2025-11-22 13:16:18,262 - INFO - Epoch 5/50: LR: 0.000990
2025-11-22 13:16:44,505 - INFO - Epoch 5/50: Train Loss: 1.3213, Val Loss: 1.6147, Val Acc: 56.53%, Test Loss: 1.6201, Test Acc: 55.43%
2025-11-22 13:18:02,396 - INFO - Epoch 6/50: LR: 0.000983
2025-11-22 13:18:02,398 - INFO - Epoch 6/50: Train Loss: 1.2294, Val Loss: 1.6050, Val Acc: 56.98%
2025-11-22 13:19:19,714 - INFO - Epoch 7/50: LR: 0.000973
2025-11-22 13:19:19,715 - INFO - Epoch 7/50: Train Loss: 1.1658, Val Loss: 1.6453, Val Acc: 56.29%
2025-11-22 13:20:36,932 - INFO - Epoch 8/50: LR: 0.000962
2025-11-22 13:20:36,934 - INFO - Epoch 8/50: Train Loss: 1.1079, Val Loss: 1.6453, Val Acc: 56.63%
2025-11-22 13:21:54,070 - INFO - Epoch 9/50: LR: 0.000948
2025-11-22 13:21:54,072 - INFO - Epoch 9/50: Train Loss: 1.0726, Val Loss: 1.7096, Val Acc: 55.75%
2025-11-22 13:23:11,223 - INFO - Epoch 10/50: LR: 0.000933
2025-11-22 13:23:37,317 - INFO - Epoch 10/50: Train Loss: 1.0459, Val Loss: 1.7126, Val Acc: 55.41%, Test Loss: 1.7226, Test Acc: 54.90%
2025-11-22 13:23:37,318 - INFO - Saving checkpoint for epoch 10...
2025-11-22 13:23:37,741 - INFO - ✅ Checkpoint saved: checkpoints/checkpoint_epoch_10.pth
2025-11-22 13:24:54,124 - INFO - Epoch 11/50: LR: 0.000916
2025-11-22 13:24:54,126 - INFO - Epoch 11/50: Train Loss: 1.0069, Val Loss: 1.7536, Val Acc: 55.09%
2025-11-22 13:26:10,591 - INFO - Epoch 12/50: LR: 0.000897
2025-11-22 13:26:10,593 - INFO - Epoch 12/50: Train Loss: 0.9881, Val Loss: 1.7386, Val Acc: 55.43%
2025-11-22 13:27:27,067 - INFO - Epoch 13/50: LR: 0.000876
2025-11-22 13:27:27,068 - INFO - Epoch 13/50: Train Loss: 0.9692, Val Loss: 1.7796, Val Acc: 55.54%
2025-11-22 13:28:43,218 - INFO - Epoch 14/50: LR: 0.000854
2025-11-22 13:28:43,220 - INFO - Epoch 14/50: Train Loss: 0.9457, Val Loss: 1.7843, Val Acc: 55.59%
2025-11-22 13:29:59,635 - INFO - Epoch 15/50: LR: 0.000830
2025-11-22 13:30:25,338 - INFO - Epoch 15/50: Train Loss: 0.9286, Val Loss: 1.8135, Val Acc: 55.02%, Test Loss: 1.8244, Test Acc: 54.13%
2025-11-22 13:31:41,664 - INFO - Epoch 16/50: LR: 0.000804
2025-11-22 13:31:41,666 - INFO - Epoch 16/50: Train Loss: 0.9096, Val Loss: 1.8109, Val Acc: 55.35%
2025-11-22 13:32:57,639 - INFO - Epoch 17/50: LR: 0.000778
2025-11-22 13:32:57,641 - INFO - Epoch 17/50: Train Loss: 0.9133, Val Loss: 1.8322, Val Acc: 55.30%
2025-11-22 13:34:13,450 - INFO - Epoch 18/50: LR: 0.000750
2025-11-22 13:34:13,452 - INFO - Epoch 18/50: Train Loss: 0.8826, Val Loss: 1.8445, Val Acc: 55.01%
2025-11-22 13:35:28,932 - INFO - Epoch 19/50: LR: 0.000721
2025-11-22 13:35:28,934 - INFO - Epoch 19/50: Train Loss: 0.8760, Val Loss: 1.8137, Val Acc: 55.74%
2025-11-22 13:36:44,546 - INFO - Epoch 20/50: LR: 0.000691
2025-11-22 13:37:10,205 - INFO - Epoch 20/50: Train Loss: 0.8650, Val Loss: 1.8646, Val Acc: 54.65%, Test Loss: 1.8742, Test Acc: 53.89%
2025-11-22 13:37:10,207 - INFO - Saving checkpoint for epoch 20...
2025-11-22 13:37:10,462 - INFO - ✅ Checkpoint saved: checkpoints/checkpoint_epoch_20.pth
2025-11-22 13:38:26,161 - INFO - Epoch 21/50: LR: 0.000661
2025-11-22 13:38:26,163 - INFO - Epoch 21/50: Train Loss: 0.8623, Val Loss: 1.8608, Val Acc: 55.61%
2025-11-22 13:39:41,757 - INFO - Epoch 22/50: LR: 0.000629
2025-11-22 13:39:41,759 - INFO - Epoch 22/50: Train Loss: 0.8428, Val Loss: 1.8608, Val Acc: 55.49%
2025-11-22 13:40:57,529 - INFO - Epoch 23/50: LR: 0.000598
2025-11-22 13:40:57,530 - INFO - Epoch 23/50: Train Loss: 0.8238, Val Loss: 1.8734, Val Acc: 55.07%
2025-11-22 13:42:12,915 - INFO - Epoch 24/50: LR: 0.000565
2025-11-22 13:42:12,917 - INFO - Epoch 24/50: Train Loss: 0.8256, Val Loss: 1.8952, Val Acc: 54.24%
2025-11-22 13:43:28,464 - INFO - Epoch 25/50: LR: 0.000533
2025-11-22 13:43:54,005 - INFO - Epoch 25/50: Train Loss: 0.8103, Val Loss: 1.8751, Val Acc: 55.03%, Test Loss: 1.9093, Test Acc: 53.64%
2025-11-22 13:45:09,427 - INFO - Epoch 26/50: LR: 0.000500
2025-11-22 13:45:09,430 - INFO - Epoch 26/50: Train Loss: 0.8106, Val Loss: 1.9239, Val Acc: 54.60%
2025-11-22 13:46:24,933 - INFO - Epoch 27/50: LR: 0.000467
2025-11-22 13:46:24,935 - INFO - Epoch 27/50: Train Loss: 0.8022, Val Loss: 1.9085, Val Acc: 54.90%
2025-11-22 13:47:40,533 - INFO - Epoch 28/50: LR: 0.000435
2025-11-22 13:47:40,534 - INFO - Epoch 28/50: Train Loss: 0.7802, Val Loss: 1.9288, Val Acc: 54.45%
2025-11-22 13:48:56,093 - INFO - Epoch 29/50: LR: 0.000402
2025-11-22 13:48:56,095 - INFO - Epoch 29/50: Train Loss: 0.7797, Val Loss: 1.9055, Val Acc: 54.78%
2025-11-22 13:50:11,659 - INFO - Epoch 30/50: LR: 0.000371
2025-11-22 13:50:37,307 - INFO - Epoch 30/50: Train Loss: 0.7764, Val Loss: 1.8798, Val Acc: 55.17%, Test Loss: 1.8922, Test Acc: 54.43%
2025-11-22 13:50:37,309 - INFO - Saving checkpoint for epoch 30...
2025-11-22 13:50:37,643 - INFO - ✅ Checkpoint saved: checkpoints/checkpoint_epoch_30.pth
2025-11-22 13:51:53,186 - INFO - Epoch 31/50: LR: 0.000339
2025-11-22 13:51:53,187 - INFO - Epoch 31/50: Train Loss: 0.7708, Val Loss: 1.8804, Val Acc: 55.77%
2025-11-22 13:53:08,869 - INFO - Epoch 32/50: LR: 0.000309
2025-11-22 13:53:08,871 - INFO - Epoch 32/50: Train Loss: 0.7673, Val Loss: 1.9574, Val Acc: 54.67%
2025-11-22 13:54:24,410 - INFO - Epoch 33/50: LR: 0.000279
2025-11-22 13:54:24,411 - INFO - Epoch 33/50: Train Loss: 0.7556, Val Loss: 1.9588, Val Acc: 54.15%
2025-11-22 13:55:39,900 - INFO - Epoch 34/50: LR: 0.000250
2025-11-22 13:55:39,902 - INFO - Epoch 34/50: Train Loss: 0.7447, Val Loss: 1.9239, Val Acc: 54.57%
2025-11-22 13:56:55,365 - INFO - Epoch 35/50: LR: 0.000222
2025-11-22 13:57:20,828 - INFO - Epoch 35/50: Train Loss: 0.7402, Val Loss: 1.8979, Val Acc: 55.18%, Test Loss: 1.9164, Test Acc: 53.88%
2025-11-22 13:58:36,316 - INFO - Epoch 36/50: LR: 0.000196
2025-11-22 13:58:36,318 - INFO - Epoch 36/50: Train Loss: 0.7463, Val Loss: 1.9118, Val Acc: 55.05%
2025-11-22 13:59:51,871 - INFO - Epoch 37/50: LR: 0.000170
2025-11-22 13:59:51,873 - INFO - Epoch 37/50: Train Loss: 0.7299, Val Loss: 1.9097, Val Acc: 54.82%
2025-11-22 14:01:07,508 - INFO - Epoch 38/50: LR: 0.000146
2025-11-22 14:01:07,510 - INFO - Epoch 38/50: Train Loss: 0.7237, Val Loss: 1.8838, Val Acc: 55.89%
2025-11-22 14:02:22,985 - INFO - Epoch 39/50: LR: 0.000124
2025-11-22 14:02:22,987 - INFO - Epoch 39/50: Train Loss: 0.7230, Val Loss: 1.9124, Val Acc: 55.14%
2025-11-22 14:03:38,502 - INFO - Epoch 40/50: LR: 0.000103
2025-11-22 14:04:04,055 - INFO - Epoch 40/50: Train Loss: 0.7074, Val Loss: 1.9456, Val Acc: 54.60%, Test Loss: 1.9522, Test Acc: 53.83%
2025-11-22 14:04:04,057 - INFO - Saving checkpoint for epoch 40...
2025-11-22 14:04:04,364 - INFO - ✅ Checkpoint saved: checkpoints/checkpoint_epoch_40.pth
2025-11-22 14:05:19,785 - INFO - Epoch 41/50: LR: 0.000084
2025-11-22 14:05:19,787 - INFO - Epoch 41/50: Train Loss: 0.7132, Val Loss: 1.9350, Val Acc: 55.02%
2025-11-22 14:06:35,248 - INFO - Epoch 42/50: LR: 0.000067
2025-11-22 14:06:35,249 - INFO - Epoch 42/50: Train Loss: 0.7069, Val Loss: 1.9560, Val Acc: 54.37%
2025-11-22 14:07:50,667 - INFO - Epoch 43/50: LR: 0.000052
2025-11-22 14:07:50,669 - INFO - Epoch 43/50: Train Loss: 0.7048, Val Loss: 1.9040, Val Acc: 55.08%
2025-11-22 14:09:06,441 - INFO - Epoch 44/50: LR: 0.000038
2025-11-22 14:09:06,443 - INFO - Epoch 44/50: Train Loss: 0.7073, Val Loss: 1.8931, Val Acc: 55.47%
2025-11-22 14:10:22,184 - INFO - Epoch 45/50: LR: 0.000027
2025-11-22 14:10:47,729 - INFO - Epoch 45/50: Train Loss: 0.7043, Val Loss: 1.8890, Val Acc: 55.12%, Test Loss: 1.9073, Test Acc: 54.05%
2025-11-22 14:12:03,126 - INFO - Epoch 46/50: LR: 0.000017
2025-11-22 14:12:03,127 - INFO - Epoch 46/50: Train Loss: 0.6910, Val Loss: 1.9112, Val Acc: 54.89%
2025-11-22 14:13:18,590 - INFO - Epoch 47/50: LR: 0.000010
2025-11-22 14:13:18,591 - INFO - Epoch 47/50: Train Loss: 0.6990, Val Loss: 1.8978, Val Acc: 55.71%
2025-11-22 14:14:34,293 - INFO - Epoch 48/50: LR: 0.000004
2025-11-22 14:14:34,295 - INFO - Epoch 48/50: Train Loss: 0.6936, Val Loss: 1.8871, Val Acc: 55.27%
2025-11-22 14:15:49,719 - INFO - Epoch 49/50: LR: 0.000001
2025-11-22 14:15:49,721 - INFO - Epoch 49/50: Train Loss: 0.6907, Val Loss: 1.9353, Val Acc: 54.71%
2025-11-22 14:17:05,308 - INFO - Epoch 50/50: LR: 0.000000
2025-11-22 14:17:30,878 - INFO - Epoch 50/50: Train Loss: 0.6888, Val Loss: 1.9223, Val Acc: 54.53%, Test Loss: 1.9470, Test Acc: 53.47%
2025-11-22 14:17:30,880 - INFO - Saving checkpoint for epoch 50...
2025-11-22 14:17:31,117 - INFO - ✅ Checkpoint saved: checkpoints/checkpoint_epoch_50.pth
2025-11-22 14:17:31,119 - INFO - Training completed!
2025-11-22 14:17:31,120 - INFO - Finished training reference model (HF)!
2025-11-22 14:17:31,122 - INFO - Generating training curves...
2025-11-22 14:17:34,812 - INFO - Training curves saved as separate images with base name 'runs/run_42/training_curves_reference'
2025-11-22 14:17:34,814 - INFO - Generating confusion matrix on test set...
2025-11-22 14:18:12,147 - INFO - Performing final evaluation of reference model on test set...
2025-11-22 14:18:37,696 - INFO - Final Test Results of reference model: Loss: 1.9470, Accuracy: 53.47%
2025-11-22 14:18:37,698 - INFO - Generating LR schedule plot of reference model...
2025-11-22 14:18:38,027 - INFO - LR schedule plot saved to 'runs/run_42/lr_schedule_reference.png'
2025-11-22 14:18:38,028 - INFO - 
Final Test Results:
2025-11-22 14:18:38,030 - INFO - Loss: 1.9470
2025-11-22 14:18:38,031 - INFO - Accuracy: 53.47%
2025-11-22 14:18:38,032 - INFO - Precision: 53.99%
2025-11-22 14:18:38,034 - INFO - Recall: 53.47%
2025-11-22 14:18:38,035 - INFO - F1 Score: 53.42%
2025-11-22 14:18:38,076 - INFO - Experiment completed. Results saved to runs/run_42/results_reference.json
2025-11-22 14:18:38,080 - INFO - Experiment completed. Metadata saved to runs/run_42/metadata_reference.json
2025-11-22 14:18:38,385 - INFO - ✅ Model weights saved: trained_models/CIFAR100_final_model_reference_weights.pth
