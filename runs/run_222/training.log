2025-12-17 00:18:58,800 - INFO - Logging initialized. Log file: runs/run_222/training.log
2025-12-17 00:18:58,846 - INFO - Experiment directory: runs/run_222
2025-12-17 00:18:58,848 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-17 00:18:58,868 - INFO - ✅ All seeds set to 42 (deterministic=False)
2025-12-17 00:18:59,335 - INFO - GPU memory cleared at startup. Available: 23.6GB
2025-12-17 00:18:59,337 - INFO - Using device: cuda
2025-12-17 00:18:59,339 - INFO - Training configuration: epochs=15, warmup=1, lr=0.0015
2025-12-17 00:18:59,340 - INFO - VIT configuration: {'type': 'vit', 'img_size': 224, 'patch_size': 16, 'embed_dim': 448, 'depth': 12, 'num_heads': 7, 'mlp_ratio': 4.0, 'num_classes': 1000, 'use_gradient_checkpointing': True}
2025-12-17 00:18:59,342 - INFO - Loading dataset...
2025-12-17 00:18:59,346 - INFO - Starting ImageNet data loading from root: /
2025-12-17 00:18:59,348 - INFO - Resolved root path: /
2025-12-17 00:18:59,350 - INFO - Root path exists: True
2025-12-17 00:18:59,352 - INFO - Root path is dir: True
2025-12-17 00:18:59,364 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var', '/meta', '/train_set', '/train_set_small', '/val_set', '/val_set_unlabeled']
2025-12-17 00:18:59,365 - INFO - Expected train_dir: /train_set, exists: True
2025-12-17 00:18:59,367 - INFO - Expected val_dir: /val_set, exists: True
2025-12-17 00:19:13,619 - INFO - Loaded ImageNet data from /: train=1281167, val=50000
2025-12-17 00:19:13,961 - INFO - Dataset loaded: train=100000 samples (782 batches), val=50000 samples (391 batches), test=50000 samples (391 batches)
2025-12-17 00:19:18,405 - INFO - Training VIT from scratch
2025-12-17 00:19:18,449 - INFO - Initializing VIT model from scratch...
2025-12-17 00:19:18,451 - INFO - Model architecture: VIT
2025-12-17 00:19:18,453 - INFO - Model config: {'type': 'vit', 'img_size': 224, 'patch_size': 16, 'embed_dim': 448, 'depth': 12, 'num_heads': 7, 'mlp_ratio': 4.0, 'num_classes': 1000, 'use_gradient_checkpointing': True}
2025-12-17 00:19:19,708 - INFO - Model created with random initialization
2025-12-17 00:19:19,710 - INFO - Total parameters: 29,854,376
2025-12-17 00:19:19,711 - INFO - Trainable parameters: 29,854,376
2025-12-17 00:19:19,836 - INFO - Starting from-scratch training...
2025-12-17 00:19:19,838 - INFO - Optimizer: training all model parameters
2025-12-17 00:19:19,842 - INFO - LR Scheduler: cosine with 1 warmup epochs
2025-12-17 00:19:19,844 - INFO - Starting training...
2025-12-17 01:13:00,082 - INFO - Epoch 1/15: LR: 0.001500
2025-12-17 01:13:00,090 - INFO - Epoch 1/15: Train Loss: 6.8510, Val Loss: 6.7194, Val Acc: 0.79%
2025-12-17 01:56:33,258 - INFO - Epoch 2/15: LR: 0.001482
2025-12-17 01:56:33,267 - INFO - Epoch 2/15: Train Loss: 6.8512, Val Loss: 6.7129, Val Acc: 0.53%
2025-12-17 02:40:39,274 - INFO - Epoch 3/15: LR: 0.001431
2025-12-17 02:40:39,312 - INFO - Epoch 3/15: Train Loss: 6.7845, Val Loss: 6.6525, Val Acc: 0.68%
2025-12-17 03:24:18,699 - INFO - Epoch 4/15: LR: 0.001347
2025-12-17 03:24:18,719 - INFO - Epoch 4/15: Train Loss: 6.7473, Val Loss: 6.7065, Val Acc: 0.56%
2025-12-17 04:07:04,318 - INFO - Epoch 5/15: LR: 0.001236
2025-12-17 04:21:07,925 - INFO - Epoch 5/15: Train Loss: 6.7732, Val Loss: 6.7144, Val Acc: 0.56%, Test Loss: 6.7144, Test Acc: 0.56%
2025-12-17 05:04:37,577 - INFO - Epoch 6/15: LR: 0.001104
2025-12-17 05:04:37,589 - INFO - Epoch 6/15: Train Loss: 6.7636, Val Loss: 6.7540, Val Acc: 0.49%
2025-12-17 05:47:23,616 - INFO - Epoch 7/15: LR: 0.000956
2025-12-17 05:47:23,985 - INFO - Epoch 7/15: Train Loss: 6.7596, Val Loss: 6.6730, Val Acc: 0.66%
2025-12-17 06:29:55,018 - INFO - Epoch 8/15: LR: 0.000800
2025-12-17 06:29:55,033 - INFO - Epoch 8/15: Train Loss: 6.7649, Val Loss: 6.6836, Val Acc: 0.70%
2025-12-17 07:12:55,628 - INFO - Epoch 9/15: LR: 0.000644
2025-12-17 07:12:55,655 - INFO - Epoch 9/15: Train Loss: 6.7382, Val Loss: 6.6683, Val Acc: 0.57%
2025-12-17 07:55:24,170 - INFO - Epoch 10/15: LR: 0.000496
2025-12-17 08:09:28,259 - INFO - Epoch 10/15: Train Loss: 6.7486, Val Loss: 6.7308, Val Acc: 0.56%, Test Loss: 6.7308, Test Acc: 0.56%
2025-12-17 08:09:28,290 - INFO - Saving checkpoint for epoch 10...
2025-12-17 08:09:29,879 - INFO - ✅ Checkpoint saved: runs/run_222/checkpoint_epoch_10.pth
2025-12-17 08:51:49,277 - INFO - Epoch 11/15: LR: 0.000364
2025-12-17 08:51:49,313 - INFO - Epoch 11/15: Train Loss: 6.7685, Val Loss: 6.6797, Val Acc: 0.65%
2025-12-17 09:34:24,425 - INFO - Epoch 12/15: LR: 0.000253
2025-12-17 09:34:24,464 - INFO - Epoch 12/15: Train Loss: 6.7436, Val Loss: 6.6637, Val Acc: 0.74%
2025-12-17 10:16:38,333 - INFO - Epoch 13/15: LR: 0.000169
2025-12-17 10:16:38,351 - INFO - Epoch 13/15: Train Loss: 6.7132, Val Loss: 6.6174, Val Acc: 0.84%
2025-12-17 10:59:20,135 - INFO - Epoch 14/15: LR: 0.000118
2025-12-17 10:59:20,152 - INFO - Epoch 14/15: Train Loss: 6.6874, Val Loss: 6.5921, Val Acc: 0.94%
2025-12-17 11:42:01,750 - INFO - Epoch 15/15: LR: 0.000100
2025-12-17 11:56:12,278 - INFO - Epoch 15/15: Train Loss: 6.6723, Val Loss: 6.5766, Val Acc: 0.93%, Test Loss: 6.5766, Test Acc: 0.93%
2025-12-17 11:56:12,291 - INFO - Training completed!
2025-12-17 11:56:12,304 - INFO - Training completed!
2025-12-17 11:56:12,306 - INFO - Generating training curves...
2025-12-17 11:56:15,761 - INFO - Too many classes (1000) for per-class plotting, skipping
2025-12-17 11:56:15,762 - INFO - Training curves saved as separate images with base name 'runs/run_222/training_curves_from_scratch'
2025-12-17 11:56:15,764 - INFO - Generating confusion matrix on test set...
2025-12-17 12:59:37,108 - INFO - Performing final evaluation of from_scratch model on test set...
2025-12-17 13:15:48,448 - INFO - Final Test Results of from_scratch model: Loss: 6.5766, Accuracy: 0.93%
2025-12-17 13:15:48,457 - INFO - Generating LR schedule plot of from_scratch model...
2025-12-17 13:15:49,200 - INFO - LR schedule plot saved to 'runs/run_222/lr_schedule_from_scratch.png'
2025-12-17 13:15:49,202 - INFO - 
Final Test Results:
2025-12-17 13:15:49,204 - INFO - Loss: 6.5766
2025-12-17 13:15:49,205 - INFO - Accuracy: 0.93%
2025-12-17 13:15:49,207 - INFO - Precision: 0.25%
2025-12-17 13:15:49,209 - INFO - Recall: 0.93%
2025-12-17 13:15:49,210 - INFO - F1 Score: 0.27%
2025-12-17 13:15:49,514 - INFO - Experiment completed. Results saved to runs/run_222/results_from_scratch.json
2025-12-17 13:15:49,518 - INFO - Experiment completed. Metadata saved to runs/run_222/metadata_from_scratch.json
2025-12-17 13:15:50,019 - INFO - ✅ Model weights saved: runs/run_222/final_model_from_scratch_weights.pth
2025-12-17 13:15:50,041 - INFO - Final model saved: runs/run_222/final_model_from_scratch_weights.pth
2025-12-17 13:15:50,042 - INFO - Final model metadata saved: runs/run_222/final_model_from_scratch_metadata.json
2025-12-17 13:15:50,044 - INFO - === FROM-SCRATCH RESULTS (IMAGENET) ===
2025-12-17 13:15:50,046 - INFO - Final Accuracy: 0.93%
2025-12-17 13:15:50,047 - INFO - Final F1 Score: 0.27%
2025-12-17 13:15:50,051 - INFO - from_scratch experiment completed successfully!
