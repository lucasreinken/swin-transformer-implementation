2025-12-17 13:17:29,017 - INFO - Logging initialized. Log file: runs/run_224/training.log
2025-12-17 13:17:29,019 - INFO - Experiment directory: runs/run_224
2025-12-17 13:17:29,021 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-17 13:17:29,041 - INFO - ✅ All seeds set to 42 (deterministic=False)
2025-12-17 13:17:29,476 - INFO - GPU memory cleared at startup. Available: 23.6GB
2025-12-17 13:17:29,477 - INFO - Using device: cuda
2025-12-17 13:17:29,479 - INFO - Training configuration: epochs=15, warmup=1, lr=0.0015
2025-12-17 13:17:29,481 - INFO - VIT configuration: {'type': 'vit', 'img_size': 224, 'patch_size': 16, 'embed_dim': 448, 'depth': 12, 'num_heads': 7, 'mlp_ratio': 4.0, 'num_classes': 1000, 'use_gradient_checkpointing': True}
2025-12-17 13:17:29,483 - INFO - Loading dataset...
2025-12-17 13:17:29,488 - INFO - Starting ImageNet data loading from root: /
2025-12-17 13:17:29,490 - INFO - Resolved root path: /
2025-12-17 13:17:29,491 - INFO - Root path exists: True
2025-12-17 13:17:29,493 - INFO - Root path is dir: True
2025-12-17 13:17:29,503 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var', '/meta', '/train_set', '/train_set_small', '/val_set', '/val_set_unlabeled']
2025-12-17 13:17:29,505 - INFO - Expected train_dir: /train_set, exists: True
2025-12-17 13:17:29,507 - INFO - Expected val_dir: /val_set, exists: True
2025-12-17 13:17:43,836 - INFO - Loaded ImageNet data from /: train=1281167, val=50000
2025-12-17 13:17:44,196 - INFO - Dataset loaded: train=100000 samples (782 batches), val=50000 samples (391 batches), test=50000 samples (391 batches)
2025-12-17 13:17:48,357 - INFO - Training VIT from scratch
2025-12-17 13:17:48,362 - INFO - Initializing VIT model from scratch...
2025-12-17 13:17:48,364 - INFO - Model architecture: VIT
2025-12-17 13:17:48,365 - INFO - Model config: {'type': 'vit', 'img_size': 224, 'patch_size': 16, 'embed_dim': 448, 'depth': 12, 'num_heads': 7, 'mlp_ratio': 4.0, 'num_classes': 1000, 'use_gradient_checkpointing': True}
2025-12-17 13:17:49,566 - INFO - Model created with random initialization
2025-12-17 13:17:49,567 - INFO - Total parameters: 29,854,376
2025-12-17 13:17:49,569 - INFO - Trainable parameters: 29,854,376
2025-12-17 13:17:49,661 - INFO - Starting from-scratch training...
2025-12-17 13:17:49,663 - INFO - Optimizer: training all model parameters
2025-12-17 13:17:49,667 - INFO - LR Scheduler: cosine with 1 warmup epochs
2025-12-17 13:17:49,669 - INFO - Starting training...
2025-12-17 14:08:27,494 - INFO - Epoch 1/15: LR: 0.001500
2025-12-17 14:08:27,517 - INFO - Epoch 1/15: Train Loss: 6.8510, Val Loss: 6.7194, Val Acc: 0.79%
2025-12-17 14:52:48,261 - INFO - Epoch 2/15: LR: 0.001482
2025-12-17 14:52:48,277 - INFO - Epoch 2/15: Train Loss: 6.8707, Val Loss: 6.7303, Val Acc: 0.54%
2025-12-17 15:36:26,847 - INFO - Epoch 3/15: LR: 0.001431
2025-12-17 15:36:26,871 - INFO - Epoch 3/15: Train Loss: 6.8062, Val Loss: 6.8039, Val Acc: 0.31%
2025-12-17 16:19:29,939 - INFO - Epoch 4/15: LR: 0.001347
2025-12-17 16:19:29,949 - INFO - Epoch 4/15: Train Loss: 6.7928, Val Loss: 6.9356, Val Acc: 0.16%
2025-12-17 17:01:57,797 - INFO - Epoch 5/15: LR: 0.001236
2025-12-17 17:15:57,519 - INFO - Epoch 5/15: Train Loss: 6.8554, Val Loss: 6.8096, Val Acc: 0.31%, Test Loss: 6.8096, Test Acc: 0.31%
2025-12-17 18:00:25,599 - INFO - Epoch 6/15: LR: 0.001104
2025-12-17 18:00:25,645 - INFO - Epoch 6/15: Train Loss: 6.8038, Val Loss: 6.7462, Val Acc: 0.41%
2025-12-17 18:43:47,685 - INFO - Epoch 7/15: LR: 0.000956
2025-12-17 18:43:47,699 - INFO - Epoch 7/15: Train Loss: 6.7873, Val Loss: 6.7471, Val Acc: 0.43%
2025-12-17 19:26:03,324 - INFO - Epoch 8/15: LR: 0.000800
2025-12-17 19:26:03,351 - INFO - Epoch 8/15: Train Loss: 6.7659, Val Loss: 6.7199, Val Acc: 0.44%
2025-12-17 20:09:32,950 - INFO - Epoch 9/15: LR: 0.000644
2025-12-17 20:09:32,959 - INFO - Epoch 9/15: Train Loss: 6.7508, Val Loss: 6.6740, Val Acc: 0.56%
2025-12-17 20:52:05,412 - INFO - Epoch 10/15: LR: 0.000496
2025-12-17 21:06:11,676 - INFO - Epoch 10/15: Train Loss: 6.7499, Val Loss: 6.6843, Val Acc: 0.61%, Test Loss: 6.6843, Test Acc: 0.61%
2025-12-17 21:06:11,678 - INFO - Saving checkpoint for epoch 10...
2025-12-17 21:06:13,210 - INFO - ✅ Checkpoint saved: runs/run_224/checkpoint_epoch_10.pth
2025-12-17 21:49:08,707 - INFO - Epoch 11/15: LR: 0.000364
2025-12-17 21:49:08,710 - INFO - Epoch 11/15: Train Loss: 6.7275, Val Loss: 6.6650, Val Acc: 0.66%
2025-12-17 22:32:17,574 - INFO - Epoch 12/15: LR: 0.000253
2025-12-17 22:32:17,977 - INFO - Epoch 12/15: Train Loss: 6.6939, Val Loss: 6.6130, Val Acc: 0.77%
2025-12-17 23:18:03,554 - INFO - Epoch 13/15: LR: 0.000169
2025-12-17 23:18:03,602 - INFO - Epoch 13/15: Train Loss: 6.6921, Val Loss: 6.5989, Val Acc: 0.81%
2025-12-18 00:03:17,171 - INFO - Epoch 14/15: LR: 0.000118
2025-12-18 00:03:17,202 - INFO - Epoch 14/15: Train Loss: 6.6620, Val Loss: 6.5889, Val Acc: 0.91%
2025-12-18 00:50:08,768 - INFO - Epoch 15/15: LR: 0.000100
2025-12-18 01:04:03,207 - INFO - Epoch 15/15: Train Loss: 6.6526, Val Loss: 6.5644, Val Acc: 0.93%, Test Loss: 6.5644, Test Acc: 0.93%
2025-12-18 01:04:03,241 - INFO - Training completed!
2025-12-18 01:04:03,250 - INFO - Training completed!
2025-12-18 01:04:03,253 - INFO - Generating training curves...
2025-12-18 01:04:07,318 - INFO - Too many classes (1000) for per-class plotting, skipping
2025-12-18 01:04:07,319 - INFO - Training curves saved as separate images with base name 'runs/run_224/training_curves_from_scratch'
2025-12-18 01:04:07,321 - INFO - Generating confusion matrix on test set...
2025-12-18 02:07:27,806 - INFO - Performing final evaluation of from_scratch model on test set...
2025-12-18 02:22:49,657 - INFO - Final Test Results of from_scratch model: Loss: 6.5644, Accuracy: 0.93%
2025-12-18 02:22:49,699 - INFO - Generating LR schedule plot of from_scratch model...
2025-12-18 02:22:50,511 - INFO - LR schedule plot saved to 'runs/run_224/lr_schedule_from_scratch.png'
2025-12-18 02:22:50,513 - INFO - 
Final Test Results:
2025-12-18 02:22:50,515 - INFO - Loss: 6.5644
2025-12-18 02:22:50,516 - INFO - Accuracy: 0.93%
2025-12-18 02:22:50,518 - INFO - Precision: 0.27%
2025-12-18 02:22:50,520 - INFO - Recall: 0.93%
2025-12-18 02:22:50,521 - INFO - F1 Score: 0.22%
2025-12-18 02:22:50,846 - INFO - Experiment completed. Results saved to runs/run_224/results_from_scratch.json
2025-12-18 02:22:50,850 - INFO - Experiment completed. Metadata saved to runs/run_224/metadata_from_scratch.json
2025-12-18 02:22:51,367 - INFO - ✅ Model weights saved: runs/run_224/final_model_from_scratch_weights.pth
2025-12-18 02:22:51,372 - INFO - Final model saved: runs/run_224/final_model_from_scratch_weights.pth
2025-12-18 02:22:51,374 - INFO - Final model metadata saved: runs/run_224/final_model_from_scratch_metadata.json
2025-12-18 02:22:51,376 - INFO - === FROM-SCRATCH RESULTS (IMAGENET) ===
2025-12-18 02:22:51,377 - INFO - Final Accuracy: 0.93%
2025-12-18 02:22:51,378 - INFO - Final F1 Score: 0.22%
2025-12-18 02:22:51,383 - INFO - from_scratch experiment completed successfully!
