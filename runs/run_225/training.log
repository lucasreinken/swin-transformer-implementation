2025-12-18 02:24:16,535 - INFO - Logging initialized. Log file: runs/run_225/training.log
2025-12-18 02:24:17,011 - INFO - Experiment directory: runs/run_225
2025-12-18 02:24:17,012 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-18 02:24:17,127 - INFO - ✅ All seeds set to 42 (deterministic=False)
2025-12-18 02:24:17,557 - INFO - GPU memory cleared at startup. Available: 23.5GB
2025-12-18 02:24:17,559 - INFO - Using device: cuda
2025-12-18 02:24:17,561 - INFO - Training configuration: epochs=15, warmup=1, lr=0.0015
2025-12-18 02:24:17,562 - INFO - VIT configuration: {'type': 'vit', 'img_size': 224, 'patch_size': 16, 'embed_dim': 448, 'depth': 12, 'num_heads': 7, 'mlp_ratio': 4.0, 'num_classes': 1000, 'use_gradient_checkpointing': True}
2025-12-18 02:24:17,563 - INFO - Loading dataset...
2025-12-18 02:24:17,566 - INFO - Starting ImageNet data loading from root: /
2025-12-18 02:24:17,568 - INFO - Resolved root path: /
2025-12-18 02:24:17,569 - INFO - Root path exists: True
2025-12-18 02:24:17,570 - INFO - Root path is dir: True
2025-12-18 02:24:17,579 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var', '/meta', '/train_set', '/train_set_small', '/val_set', '/val_set_unlabeled']
2025-12-18 02:24:17,580 - INFO - Expected train_dir: /train_set, exists: True
2025-12-18 02:24:17,581 - INFO - Expected val_dir: /val_set, exists: True
2025-12-18 02:24:29,833 - INFO - Loaded ImageNet data from /: train=1281167, val=50000
2025-12-18 02:24:30,052 - INFO - Dataset loaded: train=100000 samples (782 batches), val=50000 samples (391 batches), test=50000 samples (391 batches)
2025-12-18 02:24:34,826 - INFO - Training VIT from scratch
2025-12-18 02:24:34,866 - INFO - Initializing VIT model from scratch...
2025-12-18 02:24:34,868 - INFO - Model architecture: VIT
2025-12-18 02:24:34,869 - INFO - Model config: {'type': 'vit', 'img_size': 224, 'patch_size': 16, 'embed_dim': 448, 'depth': 12, 'num_heads': 7, 'mlp_ratio': 4.0, 'num_classes': 1000, 'use_gradient_checkpointing': True}
2025-12-18 02:24:35,522 - INFO - Model created with random initialization
2025-12-18 02:24:35,524 - INFO - Total parameters: 29,854,376
2025-12-18 02:24:35,525 - INFO - Trainable parameters: 29,854,376
2025-12-18 02:24:35,594 - INFO - Starting from-scratch training...
2025-12-18 02:24:35,596 - INFO - Optimizer: training all model parameters
2025-12-18 02:24:35,598 - INFO - LR Scheduler: cosine with 1 warmup epochs
2025-12-18 02:24:35,600 - INFO - Starting training...
2025-12-18 03:06:29,936 - INFO - Epoch 1/15: LR: 0.001500
2025-12-18 03:06:29,937 - INFO - Epoch 1/15: Train Loss: 6.8510, Val Loss: 6.7194, Val Acc: 0.79%
2025-12-18 03:41:16,006 - INFO - Epoch 2/15: LR: 0.001482
2025-12-18 03:41:16,027 - INFO - Epoch 2/15: Train Loss: 6.8731, Val Loss: 6.7115, Val Acc: 0.47%
2025-12-18 04:16:00,509 - INFO - Epoch 3/15: LR: 0.001431
2025-12-18 04:16:00,928 - INFO - Epoch 3/15: Train Loss: 6.7979, Val Loss: 6.7424, Val Acc: 0.53%
2025-12-18 04:50:14,174 - INFO - Epoch 4/15: LR: 0.001347
2025-12-18 04:50:14,863 - INFO - Epoch 4/15: Train Loss: 6.7454, Val Loss: 6.7391, Val Acc: 0.53%
2025-12-18 05:24:33,650 - INFO - Epoch 5/15: LR: 0.001236
2025-12-18 05:34:49,723 - INFO - Epoch 5/15: Train Loss: 6.7997, Val Loss: 6.7461, Val Acc: 0.51%, Test Loss: 6.7461, Test Acc: 0.51%
2025-12-18 06:08:15,608 - INFO - Epoch 6/15: LR: 0.001104
2025-12-18 06:08:15,639 - INFO - Epoch 6/15: Train Loss: 6.7609, Val Loss: 6.7341, Val Acc: 0.42%
2025-12-18 06:41:35,311 - INFO - Epoch 7/15: LR: 0.000956
2025-12-18 06:41:35,347 - INFO - Epoch 7/15: Train Loss: 6.7571, Val Loss: 6.6902, Val Acc: 0.61%
2025-12-18 07:15:17,008 - INFO - Epoch 8/15: LR: 0.000800
2025-12-18 07:15:17,236 - INFO - Epoch 8/15: Train Loss: 6.7502, Val Loss: 6.6827, Val Acc: 0.59%
2025-12-18 07:49:20,617 - INFO - Epoch 9/15: LR: 0.000644
2025-12-18 07:49:20,631 - INFO - Epoch 9/15: Train Loss: 6.7395, Val Loss: 6.6779, Val Acc: 0.56%
2025-12-18 08:23:19,523 - INFO - Epoch 10/15: LR: 0.000496
2025-12-18 08:33:30,120 - INFO - Epoch 10/15: Train Loss: 6.7393, Val Loss: 6.6516, Val Acc: 0.73%, Test Loss: 6.6516, Test Acc: 0.73%
2025-12-18 08:33:30,122 - INFO - Saving checkpoint for epoch 10...
2025-12-18 08:33:31,040 - INFO - ✅ Checkpoint saved: runs/run_225/checkpoint_epoch_10.pth
2025-12-18 09:07:27,743 - INFO - Epoch 11/15: LR: 0.000364
2025-12-18 09:07:27,760 - INFO - Epoch 11/15: Train Loss: 6.7067, Val Loss: 6.6108, Val Acc: 0.78%
2025-12-18 09:40:53,630 - INFO - Epoch 12/15: LR: 0.000253
2025-12-18 09:40:53,642 - INFO - Epoch 12/15: Train Loss: 6.6765, Val Loss: 6.5605, Val Acc: 0.97%
2025-12-18 10:14:23,912 - INFO - Epoch 13/15: LR: 0.000169
2025-12-18 10:14:23,928 - INFO - Epoch 13/15: Train Loss: 6.6549, Val Loss: 6.5452, Val Acc: 1.00%
2025-12-18 10:47:47,488 - INFO - Epoch 14/15: LR: 0.000118
2025-12-18 10:47:47,543 - INFO - Epoch 14/15: Train Loss: 6.6306, Val Loss: 6.5170, Val Acc: 1.13%
2025-12-18 11:22:24,483 - INFO - Epoch 15/15: LR: 0.000100
2025-12-18 11:32:32,261 - INFO - Epoch 15/15: Train Loss: 6.6165, Val Loss: 6.4979, Val Acc: 1.22%, Test Loss: 6.4979, Test Acc: 1.22%
2025-12-18 11:32:32,443 - INFO - Training completed!
2025-12-18 11:32:32,453 - INFO - Training completed!
2025-12-18 11:32:32,454 - INFO - Generating training curves...
2025-12-18 11:32:34,609 - INFO - Too many classes (1000) for per-class plotting, skipping
2025-12-18 11:32:34,610 - INFO - Training curves saved as separate images with base name 'runs/run_225/training_curves_from_scratch'
2025-12-18 11:32:34,611 - INFO - Generating confusion matrix on test set...
2025-12-18 12:02:27,287 - INFO - Performing final evaluation of from_scratch model on test set...
2025-12-18 12:14:03,882 - INFO - Final Test Results of from_scratch model: Loss: 6.4979, Accuracy: 1.22%
2025-12-18 12:14:03,904 - INFO - Generating LR schedule plot of from_scratch model...
2025-12-18 12:14:04,458 - INFO - LR schedule plot saved to 'runs/run_225/lr_schedule_from_scratch.png'
2025-12-18 12:14:04,459 - INFO - 
Final Test Results:
2025-12-18 12:14:04,460 - INFO - Loss: 6.4979
2025-12-18 12:14:04,461 - INFO - Accuracy: 1.22%
2025-12-18 12:14:04,461 - INFO - Precision: 0.50%
2025-12-18 12:14:04,462 - INFO - Recall: 1.22%
2025-12-18 12:14:04,463 - INFO - F1 Score: 0.39%
2025-12-18 12:14:04,549 - INFO - Experiment completed. Results saved to runs/run_225/results_from_scratch.json
2025-12-18 12:14:04,552 - INFO - Experiment completed. Metadata saved to runs/run_225/metadata_from_scratch.json
2025-12-18 12:14:04,966 - INFO - ✅ Model weights saved: runs/run_225/final_model_from_scratch_weights.pth
2025-12-18 12:14:04,970 - INFO - Final model saved: runs/run_225/final_model_from_scratch_weights.pth
2025-12-18 12:14:04,971 - INFO - Final model metadata saved: runs/run_225/final_model_from_scratch_metadata.json
2025-12-18 12:14:04,972 - INFO - === FROM-SCRATCH RESULTS (IMAGENET) ===
2025-12-18 12:14:04,973 - INFO - Final Accuracy: 1.22%
2025-12-18 12:14:04,974 - INFO - Final F1 Score: 0.39%
2025-12-18 12:14:04,978 - INFO - from_scratch experiment completed successfully!
