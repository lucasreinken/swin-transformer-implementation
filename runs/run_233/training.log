2025-12-22 06:11:30,048 - INFO - Logging initialized. Log file: runs/run_233/training.log
2025-12-22 06:11:30,235 - INFO - Experiment directory: runs/run_233
2025-12-22 06:11:30,237 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-22 06:11:30,301 - INFO - ✅ All seeds set to 42 (deterministic=False)
2025-12-22 06:11:30,760 - INFO - GPU memory cleared at startup. Available: 23.6GB
2025-12-22 06:11:30,762 - INFO - Using device: cuda
2025-12-22 06:11:30,763 - INFO - Training configuration: epochs=40, warmup=3, lr=0.0005
2025-12-22 06:11:30,765 - INFO - SWIN configuration: variant=tiny, use_shifted_window=True, use_relative_bias=True, use_absolute_pos_embed=False, use_hierarchical_merge=False, use_gradient_checkpointing=True
2025-12-22 06:11:30,766 - INFO - SWIN details: embed_dim=96, depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24], window_size=7
2025-12-22 06:11:30,768 - INFO - Loading dataset...
2025-12-22 06:11:30,773 - INFO - Starting ImageNet data loading from root: /
2025-12-22 06:11:30,774 - INFO - Resolved root path: /
2025-12-22 06:11:30,775 - INFO - Root path exists: True
2025-12-22 06:11:30,777 - INFO - Root path is dir: True
2025-12-22 06:11:30,788 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var', '/meta', '/train_set', '/train_set_small', '/val_set', '/val_set_unlabeled']
2025-12-22 06:11:30,790 - INFO - Expected train_dir: /train_set, exists: True
2025-12-22 06:11:30,791 - INFO - Expected val_dir: /val_set, exists: True
2025-12-22 06:11:45,176 - INFO - Loaded ImageNet data from /: train=1281167, val=50000
2025-12-22 06:11:45,543 - INFO - Dataset loaded: train=100000 samples (782 batches), val=50000 samples (391 batches), test=50000 samples (391 batches)
2025-12-22 06:11:50,787 - INFO - Training SWIN from scratch
2025-12-22 06:11:50,792 - INFO - Initializing SWIN model from scratch...
2025-12-22 06:11:50,793 - INFO - Model architecture: SWIN
2025-12-22 06:11:50,794 - INFO - Model config: {'type': 'swin', 'variant': 'tiny', 'patch_size': 4, 'embed_dim': 96, 'depths': [2, 2, 6, 2], 'num_heads': [3, 6, 12, 24], 'window_size': 7, 'mlp_ratio': 4.0, 'dropout': 0.0, 'attention_dropout': 0.0, 'projection_dropout': 0.0, 'drop_path_rate': 0.08, 'use_shifted_window': True, 'use_relative_bias': True, 'use_absolute_pos_embed': False, 'use_hierarchical_merge': False, 'use_gradient_checkpointing': True}
2025-12-22 06:11:51,879 - INFO - Model created with random initialization
2025-12-22 06:11:51,881 - INFO - Total parameters: 28,288,354
2025-12-22 06:11:51,882 - INFO - Trainable parameters: 28,288,354
2025-12-22 06:11:51,970 - INFO - Starting from-scratch training...
2025-12-22 06:11:51,972 - INFO - Optimizer: training all model parameters
2025-12-22 06:11:51,976 - INFO - LR Scheduler: cosine with 3 warmup epochs
2025-12-22 06:11:51,978 - INFO - Starting training...
2025-12-22 07:03:51,284 - INFO - Epoch 1/40: LR: 0.000170
2025-12-22 07:03:51,314 - INFO - Epoch 1/40: Train Loss: 6.8849, Val Loss: 6.7706, Val Acc: 0.46%
2025-12-22 07:48:49,092 - INFO - Epoch 2/40: LR: 0.000335
2025-12-22 07:48:49,118 - INFO - Epoch 2/40: Train Loss: 6.7454, Val Loss: 6.5014, Val Acc: 0.94%
2025-12-22 08:34:56,097 - INFO - Epoch 3/40: LR: 0.000500
2025-12-22 08:34:56,171 - INFO - Epoch 3/40: Train Loss: 6.4500, Val Loss: 6.2015, Val Acc: 1.47%
2025-12-22 09:19:16,732 - INFO - Epoch 4/40: LR: 0.000499
2025-12-22 09:19:16,735 - INFO - Epoch 4/40: Train Loss: 6.2548, Val Loss: 5.9632, Val Acc: 2.24%
2025-12-22 10:03:44,795 - INFO - Epoch 5/40: LR: 0.000497
2025-12-22 10:18:28,237 - INFO - Epoch 5/40: Train Loss: 6.0858, Val Loss: 5.8042, Val Acc: 2.91%, Test Loss: 5.8042, Test Acc: 2.91%
2025-12-22 11:02:58,505 - INFO - Epoch 6/40: LR: 0.000493
2025-12-22 11:02:58,522 - INFO - Epoch 6/40: Train Loss: 5.9519, Val Loss: 5.6380, Val Acc: 3.90%
2025-12-22 11:49:46,375 - INFO - Epoch 7/40: LR: 0.000487
2025-12-22 11:49:46,427 - INFO - Epoch 7/40: Train Loss: 5.8309, Val Loss: 5.4646, Val Acc: 5.14%
2025-12-22 12:36:15,532 - INFO - Epoch 8/40: LR: 0.000480
2025-12-22 12:36:15,571 - INFO - Epoch 8/40: Train Loss: 5.7012, Val Loss: 5.3386, Val Acc: 6.15%
2025-12-22 13:21:22,418 - INFO - Epoch 9/40: LR: 0.000471
2025-12-22 13:21:22,444 - INFO - Epoch 9/40: Train Loss: 5.5953, Val Loss: 5.2179, Val Acc: 7.01%
2025-12-22 14:07:11,999 - INFO - Epoch 10/40: LR: 0.000461
2025-12-22 14:21:36,056 - INFO - Epoch 10/40: Train Loss: 5.4983, Val Loss: 5.1257, Val Acc: 7.76%, Test Loss: 5.1257, Test Acc: 7.76%
2025-12-22 14:21:36,086 - INFO - Saving checkpoint for epoch 10...
2025-12-22 14:21:37,682 - INFO - ✅ Checkpoint saved: runs/run_233/checkpoint_epoch_10.pth
2025-12-22 15:05:32,517 - INFO - Epoch 11/40: LR: 0.000450
2025-12-22 15:05:32,560 - INFO - Epoch 11/40: Train Loss: 5.3936, Val Loss: 5.0444, Val Acc: 9.01%
2025-12-22 15:50:09,319 - INFO - Epoch 12/40: LR: 0.000437
2025-12-22 15:50:09,772 - INFO - Epoch 12/40: Train Loss: 5.2966, Val Loss: 4.9010, Val Acc: 10.13%
2025-12-22 16:34:44,850 - INFO - Epoch 13/40: LR: 0.000424
2025-12-22 16:34:44,957 - INFO - Epoch 13/40: Train Loss: 5.1931, Val Loss: 4.8455, Val Acc: 10.70%
2025-12-22 17:20:17,611 - INFO - Epoch 14/40: LR: 0.000409
2025-12-22 17:20:17,721 - INFO - Epoch 14/40: Train Loss: 5.0985, Val Loss: 4.7053, Val Acc: 12.38%
2025-12-22 18:04:54,113 - INFO - Epoch 15/40: LR: 0.000393
2025-12-22 18:19:22,861 - INFO - Epoch 15/40: Train Loss: 5.0033, Val Loss: 4.6247, Val Acc: 13.52%, Test Loss: 4.6247, Test Acc: 13.52%
2025-12-22 19:03:35,405 - INFO - Epoch 16/40: LR: 0.000376
2025-12-22 19:03:35,472 - INFO - Epoch 16/40: Train Loss: 4.9201, Val Loss: 4.5438, Val Acc: 14.22%
