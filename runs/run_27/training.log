2025-11-19 19:54:39,271 - INFO - Logging initialized. Log file: runs/run_27/training.log
2025-11-19 19:54:39,553 - INFO - Random seeds set to 42 (deterministic=False)
2025-11-19 19:54:39,554 - INFO - Using device: cuda
2025-11-19 19:54:39,555 - INFO - Loading data...
2025-11-19 19:54:43,538 - INFO - Visualizing first batch...
2025-11-19 19:54:43,539 - INFO - Visualizing from DataLoader with 1303 batches
2025-11-19 19:54:44,306 - INFO - Loaded 16 images from dataloader
2025-11-19 19:54:47,605 - INFO - Saved enhanced dataset visualization to runs/run_27/visualization.png
2025-11-19 19:54:47,607 - INFO - Initializing model...
2025-11-19 19:54:48,085 - INFO - Created SwinTransformerModel training.
2025-11-19 19:54:48,086 - INFO - Transferring weights from pretrained to custom model...
2025-11-19 19:54:48,549 - INFO - Loading pretrained weights from Hugging Face hub (timm/swin_tiny_patch4_window7_224.ms_in1k)
2025-11-19 19:54:48,799 - INFO - HTTP Request: HEAD https://huggingface.co/timm/swin_tiny_patch4_window7_224.ms_in1k/resolve/main/model.safetensors "HTTP/1.1 302 Found"
2025-11-19 19:54:48,812 - INFO - [timm/swin_tiny_patch4_window7_224.ms_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-11-19 19:54:49,076 - INFO - Loaded pretrained model: swin_tiny_patch4_window7_224 from timm.
2025-11-19 19:54:49,118 - INFO - Weight transfer: 169 layers transferred.
2025-11-19 19:54:49,141 - INFO - Weight transfer completed: {'transferred': 169, 'missing': 0, 'size_mismatches': 0}
2025-11-19 19:54:49,143 - INFO - Total parameters: 78,436
2025-11-19 19:54:49,147 - INFO - Saved configuration to runs/run_27/config.json
2025-11-19 19:54:49,148 - INFO - Starting training...
2025-11-19 19:56:18,159 - INFO - Epoch 1/50: Train Loss: 1.5417, Val Loss: 0.9531, Val Acc: 72.07%
2025-11-19 19:57:44,462 - INFO - Epoch 2/50: Train Loss: 0.8872, Val Loss: 0.8548, Val Acc: 74.76%
2025-11-19 19:59:10,714 - INFO - Epoch 3/50: Train Loss: 0.7777, Val Loss: 0.8224, Val Acc: 75.72%
2025-11-19 20:00:37,140 - INFO - Epoch 4/50: Train Loss: 0.7146, Val Loss: 0.8113, Val Acc: 76.08%
2025-11-19 20:02:32,926 - INFO - Epoch 5/50: Train Loss: 0.6756, Val Loss: 0.7987, Val Acc: 76.58%, Test Loss: 0.7973, Test Acc: 76.57%
2025-11-19 20:03:59,163 - INFO - Epoch 6/50: Train Loss: 0.6437, Val Loss: 0.8022, Val Acc: 76.36%
2025-11-19 20:05:25,343 - INFO - Epoch 7/50: Train Loss: 0.6133, Val Loss: 0.8059, Val Acc: 76.30%
2025-11-19 20:06:51,196 - INFO - Epoch 8/50: Train Loss: 0.5967, Val Loss: 0.7949, Val Acc: 76.50%
2025-11-19 20:08:17,252 - INFO - Epoch 9/50: Train Loss: 0.5771, Val Loss: 0.7971, Val Acc: 76.54%
2025-11-19 20:09:43,126 - INFO - Early stopping triggered at epoch 10.
2025-11-19 20:09:43,128 - INFO - Training completed!
2025-11-19 20:09:43,129 - INFO - Generating training curves...
2025-11-19 20:09:44,948 - INFO - Training curves saved as separate images with base name 'runs/run_27/training_curves'
2025-11-19 20:09:44,949 - INFO - Generating confusion matrix on test set...
2025-11-19 20:10:25,595 - INFO - Performing final evaluation on test set...
2025-11-19 20:10:55,026 - INFO - Final Test Results: Loss: 0.8047, Accuracy: 76.32%
2025-11-19 20:10:55,027 - INFO - Generating LR schedule plot...
2025-11-19 20:10:55,318 - INFO - LR schedule plot saved to 'runs/run_27/lr_schedule.png'
2025-11-19 20:10:55,319 - INFO - 
Final Test Results:
2025-11-19 20:10:55,320 - INFO - Loss: 0.8047
2025-11-19 20:10:55,321 - INFO - Accuracy: 76.32%
2025-11-19 20:10:55,322 - INFO - Precision: 76.69%
2025-11-19 20:10:55,322 - INFO - Recall: 76.32%
2025-11-19 20:10:55,323 - INFO - F1 Score: 76.25%
2025-11-19 20:10:55,332 - INFO - Experiment completed. Results saved to runs/run_27/results.json
2025-11-19 20:10:55,336 - INFO - Experiment completed. Metadata saved to runs/run_27/metadata.json
2025-11-19 20:10:55,653 - INFO - âœ… Model weights saved: trained_models/CIFAR100_final_model_weights.pth
