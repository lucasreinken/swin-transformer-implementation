2025-11-22 00:25:39,873 - INFO - Logging initialized. Log file: runs/run_39/training.log
2025-11-22 00:25:39,875 - INFO - Experiment directory: runs/run_39
2025-11-22 00:25:40,088 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-11-22 00:25:40,109 - INFO - Random seeds set to 42 (deterministic=False)
2025-11-22 00:25:40,110 - INFO - Setting up device...
2025-11-22 00:25:40,111 - INFO - Using device: cuda
2025-11-22 00:25:40,113 - INFO - Using device: cuda
2025-11-22 00:25:40,114 - INFO - Training configuration: epochs=50, warmup=2, lr=0.001
2025-11-22 00:25:40,115 - INFO - Using pretrained model: swin_tiny_patch4_window7_224
2025-11-22 00:25:40,116 - INFO - Model architecture: Swin-Tiny
2025-11-22 00:25:40,117 - INFO - Model config: embed_dim=96, depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24]
2025-11-22 00:25:40,118 - INFO - Image size: 224x224, patch_size: 4x4
2025-11-22 00:25:40,119 - INFO - Loading dataset...
2025-11-22 00:25:43,771 - INFO - Dataset loaded: train=1303, val=261, test=313 batches
2025-11-22 00:25:43,772 - INFO - Initializing reference model...
2025-11-22 00:25:43,773 - INFO - Loading TIMM model: swin_tiny_patch4_window7_224 with pretrained weights
2025-11-22 00:25:45,038 - INFO - Loading pretrained weights from Hugging Face hub (timm/swin_tiny_patch4_window7_224.ms_in1k)
2025-11-22 00:25:45,397 - INFO - HTTP Request: HEAD https://huggingface.co/timm/swin_tiny_patch4_window7_224.ms_in1k/resolve/main/model.safetensors "HTTP/1.1 302 Found"
2025-11-22 00:25:45,428 - INFO - [timm/swin_tiny_patch4_window7_224.ms_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-11-22 00:25:45,684 - INFO - Successfully loaded swin_tiny_patch4_window7_224 from TIMM
2025-11-22 00:25:45,685 - INFO - Encoder loaded: 768 output features
2025-11-22 00:25:45,688 - INFO - Created classification head: 768 -> 100 classes
2025-11-22 00:25:45,691 - INFO - Reference model created. Trainable params (head only): 78,436
2025-11-22 00:25:45,926 - INFO - Detected Swin Transformer architecture
2025-11-22 00:25:45,928 - INFO - Extracting model size from TIMM model name...
2025-11-22 00:25:45,929 - INFO - Detected model size: tiny
2025-11-22 00:25:45,930 - INFO - Will create custom model with: {'embed_dim': 96, 'depths': [2, 2, 6, 2], 'num_heads': [3, 6, 12, 24]}
2025-11-22 00:25:45,931 - INFO - Initializing custom Swin model (size: tiny)...
2025-11-22 00:25:45,932 - INFO - Custom model will match architecture: embed_dim=96, depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24]
2025-11-22 00:25:46,923 - INFO - Transferring weights from reference to custom encoder...
2025-11-22 00:25:46,924 - INFO - Weight transfer: SwinTransformer -> SwinTransformerModel
2025-11-22 00:25:46,958 - INFO - Weight transfer: 169 layers transferred.
2025-11-22 00:25:47,000 - INFO - Weight transfer completed: {'transferred': 169, 'missing': 0, 'size_mismatches': 0}
2025-11-22 00:25:47,001 - INFO - âœ“ All expected weights transferred successfully
2025-11-22 00:25:47,004 - INFO - Custom model created. Trainable params (head only): 78,436
2025-11-22 00:25:47,011 - INFO - Starting reference model training...
2025-11-22 00:25:47,013 - INFO - Starting training...
2025-11-22 00:28:01,366 - INFO - Epoch 1/50: LR: 0.000550
2025-11-22 00:28:01,367 - INFO - Epoch 1/50: Train Loss: 3.5903, Val Loss: 2.5830, Val Acc: 60.75%
2025-11-22 00:30:12,337 - INFO - Epoch 2/50: LR: 0.001000
2025-11-22 00:30:12,338 - INFO - Epoch 2/50: Train Loss: 1.4175, Val Loss: 1.0003, Val Acc: 71.50%
2025-11-22 00:32:23,153 - INFO - Epoch 3/50: LR: 0.000999
2025-11-22 00:32:23,154 - INFO - Epoch 3/50: Train Loss: 0.9360, Val Loss: 0.8710, Val Acc: 74.08%
2025-11-22 00:34:33,885 - INFO - Epoch 4/50: LR: 0.000996
2025-11-22 00:34:33,886 - INFO - Epoch 4/50: Train Loss: 0.7888, Val Loss: 0.8365, Val Acc: 75.23%
2025-11-22 00:36:44,465 - INFO - Epoch 5/50: LR: 0.000990
2025-11-22 00:37:28,573 - INFO - Epoch 5/50: Train Loss: 0.7097, Val Loss: 0.8237, Val Acc: 75.75%, Test Loss: 0.8227, Test Acc: 75.94%
2025-11-22 00:39:39,352 - INFO - Epoch 6/50: LR: 0.000983
2025-11-22 00:39:39,354 - INFO - Epoch 6/50: Train Loss: 0.6571, Val Loss: 0.8189, Val Acc: 76.35%
2025-11-22 00:41:50,038 - INFO - Epoch 7/50: LR: 0.000973
2025-11-22 00:41:50,039 - INFO - Epoch 7/50: Train Loss: 0.6135, Val Loss: 0.8234, Val Acc: 76.04%
