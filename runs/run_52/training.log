2025-11-27 12:52:23,050 - INFO - Logging initialized. Log file: runs/run_52/training.log
2025-11-27 12:52:23,070 - INFO - Experiment directory: runs/run_52
2025-11-27 12:52:23,070 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-11-27 12:52:23,365 - INFO - Random seeds set to 42 (deterministic=False)
2025-11-27 12:52:23,366 - INFO - Using device: cuda
2025-11-27 12:52:23,367 - INFO - Training configuration: epochs=1, warmup=0, lr=0.001
2025-11-27 12:52:23,367 - INFO - Loading dataset...
2025-11-27 12:52:27,043 - INFO - Dataset loaded: train=1303, val=261, test=313 batches
2025-11-27 12:52:30,150 - INFO - Using pretrained model: swin_large_patch4_window7_224
2025-11-27 12:52:30,151 - INFO - Model architecture: Swin-Large
2025-11-27 12:52:30,152 - INFO - Initializing reference model...
2025-11-27 12:52:30,153 - INFO - Loading TIMM model: swin_large_patch4_window7_224 with pretrained weights
2025-11-27 12:52:32,541 - INFO - Loading pretrained weights from Hugging Face hub (timm/swin_large_patch4_window7_224.ms_in22k_ft_in1k)
2025-11-27 12:52:32,768 - INFO - HTTP Request: HEAD https://huggingface.co/timm/swin_large_patch4_window7_224.ms_in22k_ft_in1k/resolve/main/model.safetensors "HTTP/1.1 302 Found"
2025-11-27 12:52:32,842 - INFO - [timm/swin_large_patch4_window7_224.ms_in22k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-11-27 12:52:35,053 - INFO - Successfully loaded swin_large_patch4_window7_224 from TIMM
2025-11-27 12:52:35,054 - INFO - Encoder loaded: 1536 output features
2025-11-27 12:52:35,056 - INFO - Created classification head: 1536 -> 100 classes
2025-11-27 12:52:35,059 - INFO - Reference model created. Trainable params (head only): 156,772
2025-11-27 12:52:35,589 - INFO - Detected Swin Transformer architecture
2025-11-27 12:52:35,590 - INFO - Detected model size: large
2025-11-27 12:52:35,591 - INFO - Initializing custom Swin model (size: large)...
2025-11-27 12:52:35,591 - INFO - Custom model will match architecture: embed_dim=192, depths=[2, 2, 18, 2], num_heads=[6, 12, 24, 48]
2025-11-27 12:52:37,791 - INFO - Transferring weights from reference to custom encoder...
2025-11-27 12:52:37,792 - INFO - Weight transfer: SwinTransformer -> SwinTransformerModel
2025-11-27 12:52:37,896 - INFO - Weight transfer: 325 layers transferred.
2025-11-27 12:52:38,029 - INFO - Weight transfer completed: {'transferred': 325, 'missing': 0, 'size_mismatches': 0}
2025-11-27 12:52:38,030 - INFO - ✓ All expected weights transferred successfully
2025-11-27 12:52:38,032 - INFO - Custom model created. Trainable params (head only): 156,772
2025-11-27 12:52:38,036 - INFO - Starting reference model training...
2025-11-27 12:52:38,037 - INFO - Optimizer: training head parameters only (encoder frozen)
2025-11-27 12:52:38,039 - INFO - Starting training...
2025-11-27 13:05:09,520 - INFO - Epoch 1/1: LR: 0.001100
2025-11-27 13:05:09,521 - INFO - Epoch 1/1: Train Loss: 2.3537, Val Loss: 0.9997, Val Acc: 84.26%
2025-11-27 13:05:09,522 - INFO - Training completed!
2025-11-27 13:05:09,523 - INFO - Reference model training completed!
2025-11-27 13:05:09,524 - INFO - Generating training curves...
2025-11-27 13:05:11,183 - INFO - Training curves saved as separate images with base name 'runs/run_52/training_curves_reference'
2025-11-27 13:05:11,184 - INFO - Generating confusion matrix on test set...
2025-11-27 13:09:38,338 - INFO - Performing final evaluation of reference model on test set...
2025-11-27 13:13:41,699 - INFO - Final Test Results of reference model: Loss: 0.9889, Accuracy: 84.06%
2025-11-27 13:13:41,732 - INFO - Generating LR schedule plot of reference model...
2025-11-27 13:13:42,438 - INFO - LR schedule plot saved to 'runs/run_52/lr_schedule_reference.png'
2025-11-27 13:13:42,439 - INFO - 
Final Test Results:
2025-11-27 13:13:42,440 - INFO - Loss: 0.9889
2025-11-27 13:13:42,441 - INFO - Accuracy: 84.06%
2025-11-27 13:13:42,442 - INFO - Precision: 84.45%
2025-11-27 13:13:42,443 - INFO - Recall: 84.06%
2025-11-27 13:13:42,444 - INFO - F1 Score: 83.87%
2025-11-27 13:13:42,489 - INFO - Experiment completed. Results saved to runs/run_52/results_reference.json
2025-11-27 13:13:42,492 - INFO - Experiment completed. Metadata saved to runs/run_52/metadata_reference.json
2025-11-27 13:13:45,203 - INFO - ✅ Model weights saved: trained_models/CIFAR100_final_model_reference_weights.pth
2025-11-27 13:13:45,204 - INFO - Starting custom model training...
2025-11-27 13:13:45,205 - INFO - Optimizer: training head parameters only (encoder frozen)
2025-11-27 13:13:45,206 - INFO - Starting training...
2025-11-27 13:25:28,793 - INFO - Epoch 1/1: LR: 0.001100
2025-11-27 13:25:28,794 - INFO - Epoch 1/1: Train Loss: 2.3660, Val Loss: 1.0002, Val Acc: 84.14%
2025-11-27 13:25:28,795 - INFO - Training completed!
2025-11-27 13:25:28,796 - INFO - Custom model training completed!
2025-11-27 13:25:28,797 - INFO - Generating training curves...
2025-11-27 13:25:30,489 - INFO - Training curves saved as separate images with base name 'runs/run_52/training_curves_custom'
2025-11-27 13:25:30,490 - INFO - Generating confusion matrix on test set...
2025-11-27 13:29:41,478 - INFO - Performing final evaluation of custom model on test set...
2025-11-27 13:33:40,382 - INFO - Final Test Results of custom model: Loss: 0.9896, Accuracy: 84.67%
2025-11-27 13:33:40,407 - INFO - Generating LR schedule plot of custom model...
2025-11-27 13:33:40,778 - INFO - LR schedule plot saved to 'runs/run_52/lr_schedule_custom.png'
2025-11-27 13:33:40,779 - INFO - 
Final Test Results:
2025-11-27 13:33:40,779 - INFO - Loss: 0.9896
2025-11-27 13:33:40,780 - INFO - Accuracy: 84.67%
2025-11-27 13:33:40,781 - INFO - Precision: 84.96%
2025-11-27 13:33:40,782 - INFO - Recall: 84.67%
2025-11-27 13:33:40,782 - INFO - F1 Score: 84.58%
2025-11-27 13:33:40,831 - INFO - Experiment completed. Results saved to runs/run_52/results_custom.json
2025-11-27 13:33:40,857 - INFO - Experiment completed. Metadata saved to runs/run_52/metadata_custom.json
2025-11-27 13:33:42,556 - INFO - ✅ Model weights saved: trained_models/CIFAR100_final_model_custom_weights.pth
2025-11-27 13:33:42,556 - INFO - === MODEL COMPARISON RESULTS (linear_probe on CIFAR100) ===
2025-11-27 13:33:42,557 - INFO - Reference (TIMM): 84.06%
2025-11-27 13:33:42,558 - INFO - Custom          : 84.67%
2025-11-27 13:33:42,559 - INFO - Difference      : 0.61%
2025-11-27 13:33:42,562 - INFO - linear_probe experiment completed successfully!
