2025-11-19 21:25:38,639 - INFO - Logging initialized. Log file: runs/run_54/training.log
2025-11-19 21:25:38,864 - INFO - Random seeds set to 42 (deterministic=False)
2025-11-19 21:25:38,867 - INFO - Using device: cuda
2025-11-19 21:25:38,868 - INFO - Loading data...
2025-11-19 21:25:42,509 - INFO - Visualizing first batch...
2025-11-19 21:25:42,511 - INFO - Visualizing from DataLoader with 1303 batches
2025-11-19 21:25:43,549 - INFO - Loaded 16 images from dataloader
2025-11-19 21:25:48,627 - INFO - Saved enhanced dataset visualization to runs/run_54/visualization.png
2025-11-19 21:25:48,630 - INFO - Initializing model...
2025-11-19 21:25:49,624 - INFO - Created SwinTransformerModel for CIFAR-100 training.
2025-11-19 21:25:49,670 - INFO - Model moved to device: cuda
2025-11-19 21:25:49,672 - INFO - Patch embed proj device: cuda:0
2025-11-19 21:25:49,674 - INFO - Encoder first layer device: cuda:0
2025-11-19 21:25:49,676 - INFO - Head device: cuda:0
2025-11-19 21:25:49,677 - INFO - Transferring weights from pretrained to custom model...
2025-11-19 21:25:50,522 - INFO - Loading pretrained weights from Hugging Face hub (timm/swin_tiny_patch4_window7_224.ms_in1k)
2025-11-19 21:25:50,882 - INFO - HTTP Request: HEAD https://huggingface.co/timm/swin_tiny_patch4_window7_224.ms_in1k/resolve/main/model.safetensors "HTTP/1.1 302 Found"
2025-11-19 21:25:50,908 - INFO - [timm/swin_tiny_patch4_window7_224.ms_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-11-19 21:25:51,165 - INFO - Loaded pretrained model: swin_tiny_patch4_window7_224 from timm.
2025-11-19 21:25:51,217 - INFO - Weight transfer: 169 layers transferred.
2025-11-19 21:25:51,226 - INFO - Weight transfer completed: {'transferred': 169, 'missing': 0, 'size_mismatches': 0}
2025-11-19 21:25:51,228 - INFO - After transfer - Patch embed proj device: cuda:0
2025-11-19 21:25:51,229 - INFO - After transfer - Encoder first layer device: cuda:0
2025-11-19 21:25:51,233 - INFO - Total parameters: 78,436
2025-11-19 21:25:51,281 - INFO - Saved configuration to runs/run_54/config.json
2025-11-19 21:25:51,285 - INFO - Starting training...
2025-11-19 21:28:08,017 - INFO - Epoch 1/50: Train Loss: 1.5417, Val Loss: 0.9531, Val Acc: 72.07%
2025-11-19 21:30:21,771 - INFO - Epoch 2/50: Train Loss: 0.8872, Val Loss: 0.8548, Val Acc: 74.76%
2025-11-19 21:32:35,401 - INFO - Epoch 3/50: Train Loss: 0.7777, Val Loss: 0.8224, Val Acc: 75.72%
2025-11-19 21:34:48,978 - INFO - Epoch 4/50: Train Loss: 0.7146, Val Loss: 0.8113, Val Acc: 76.08%
2025-11-19 21:37:47,985 - INFO - Epoch 5/50: Train Loss: 0.6756, Val Loss: 0.7987, Val Acc: 76.58%, Test Loss: 0.7973, Test Acc: 76.57%
2025-11-19 21:40:01,447 - INFO - Epoch 6/50: Train Loss: 0.6437, Val Loss: 0.8022, Val Acc: 76.36%
2025-11-19 21:42:15,088 - INFO - Epoch 7/50: Train Loss: 0.6133, Val Loss: 0.8059, Val Acc: 76.30%
2025-11-19 21:44:28,647 - INFO - Epoch 8/50: Train Loss: 0.5967, Val Loss: 0.7949, Val Acc: 76.50%
2025-11-19 21:46:42,207 - INFO - Epoch 9/50: Train Loss: 0.5771, Val Loss: 0.7971, Val Acc: 76.54%
2025-11-19 21:48:55,764 - INFO - Early stopping triggered at epoch 10.
2025-11-19 21:48:55,766 - INFO - Training completed!
2025-11-19 21:48:55,768 - INFO - Starting model implementation validation...
2025-11-19 21:48:56,777 - INFO - Loading pretrained weights from Hugging Face hub (timm/swin_tiny_patch4_window7_224.ms_in1k)
2025-11-19 21:48:56,924 - INFO - HTTP Request: HEAD https://huggingface.co/timm/swin_tiny_patch4_window7_224.ms_in1k/resolve/main/model.safetensors "HTTP/1.1 302 Found"
2025-11-19 21:48:56,958 - INFO - [timm/swin_tiny_patch4_window7_224.ms_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-11-19 21:48:57,231 - INFO - Loaded pretrained model: swin_tiny_patch4_window7_224 from timm.
2025-11-19 21:48:57,275 - INFO - Replaced TIMM head with LinearClassificationHead: 768 -> 100 classes
2025-11-19 21:48:57,277 - INFO - Both models loaded with ImageNet pretrained encoder weights
2025-11-19 21:48:57,278 - INFO - Custom model: weights loaded during main training
2025-11-19 21:48:57,280 - INFO - TIMM model: weights loaded with pretrained=True
2025-11-19 21:48:57,281 - INFO - Training TIMM model's linear head...
2025-11-19 21:48:57,283 - INFO - Training linear head for 10 epochs...
2025-11-19 21:48:57,289 - INFO - Training 78,436 parameters in linear head
2025-11-19 21:48:57,468 - INFO - Debug - Input shape: torch.Size([32, 3, 224, 224]), Label shape: torch.Size([32])
