2025-12-02 20:18:59,214 - INFO - Logging initialized. Log file: runs/run_75/training.log
2025-12-02 20:18:59,288 - INFO - Experiment directory: runs/run_75
2025-12-02 20:18:59,288 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-02 20:18:59,432 - INFO - Random seeds set to 42 (deterministic=False)
2025-12-02 20:18:59,433 - INFO - Using device: cuda
2025-12-02 20:18:59,434 - INFO - Training configuration: epochs=2, warmup=1, lr=0.0001
2025-12-02 20:18:59,434 - INFO - Loading dataset...
2025-12-02 20:18:59,435 - INFO - Starting ImageNet data loading from root: /mnt/datasets/imagenet/2012
2025-12-02 20:18:59,436 - INFO - Resolved root path: /mnt/datasets/imagenet/2012
2025-12-02 20:18:59,437 - INFO - Root path exists: True
2025-12-02 20:18:59,437 - INFO - Root path is dir: True
2025-12-02 20:18:59,438 - INFO - Contents of /mnt/datasets/imagenet/2012: ['/mnt/datasets/imagenet/2012/train_set_small', '/mnt/datasets/imagenet/2012/train_set', '/mnt/datasets/imagenet/2012/val_set_unlabeled', '/mnt/datasets/imagenet/2012/val_set', '/mnt/datasets/imagenet/2012/meta']
2025-12-02 20:18:59,439 - INFO - Expected train_dir: /mnt/datasets/imagenet/2012/train_set, exists: True
2025-12-02 20:18:59,440 - INFO - Expected val_dir: /mnt/datasets/imagenet/2012/val_set, exists: True
2025-12-02 20:18:59,440 - INFO - Loading datasets...
2025-12-02 20:19:17,963 - INFO - Loaded ImageNet data from /mnt/datasets/imagenet/2012: train=1281167, val=50000
2025-12-02 20:19:17,964 - INFO - Dataset loaded: train=10010, val=391, test=391 batches
2025-12-02 20:19:19,758 - INFO - Training Swin-Base from scratch
2025-12-02 20:19:19,759 - INFO - Initializing model from scratch...
2025-12-02 20:19:19,760 - INFO - Model architecture: Swin-Base
2025-12-02 20:19:19,761 - INFO - Model config: embed_dim=128, depths=[2, 2, 18, 2], num_heads=[4, 8, 16, 32]
2025-12-02 20:19:21,050 - INFO - Model created with random initialization
2025-12-02 20:19:21,051 - INFO - Total parameters: 87,768,224
2025-12-02 20:19:21,052 - INFO - Trainable parameters: 87,768,224
2025-12-02 20:19:21,418 - INFO - Starting from-scratch training...
2025-12-02 20:19:21,419 - INFO - Optimizer: training all model parameters
2025-12-02 20:19:21,421 - INFO - Starting training...
2025-12-02 20:19:27,855 - ERROR - Experiment failed with error: Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/torch/utils/data/_utils/worker.py", line 349, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
           ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 398, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 212, in collate
    collate(samples, collate_fn_map=collate_fn_map)
  File "/usr/local/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 155, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 272, in collate_tensor_fn
    return torch.stack(batch, 0, out=out)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: stack expects each tensor to be equal size, but got [3, 298, 224] at entry 0 and [3, 224, 298] at entry 1

2025-12-02 20:19:27,855 - ERROR - Full traceback:
Traceback (most recent call last):
  File "/home/pml04/swin_transformer/Machine-Learning-Project/main.py", line 186, in main
    run_from_scratch(
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/pipelines/from_scratch.py", line 230, in run_from_scratch
    criterion, lr_history, metrics_history = _train_single_model(
                                             ^^^^^^^^^^^^^^^^^^^^
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/pipelines/from_scratch.py", line 130, in _train_single_model
    run_training_loop(
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/training/trainer.py", line 157, in run_training_loop
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/training/trainer.py", line 57, in train_one_epoch
    for batch_idx, (inputs, labels) in enumerate(train_loader):
                                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1506, in _next_data
    return self._process_data(data, worker_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1541, in _process_data
    data.reraise()
  File "/usr/local/lib/python3.12/site-packages/torch/_utils.py", line 769, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/torch/utils/data/_utils/worker.py", line 349, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
           ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 398, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 212, in collate
    collate(samples, collate_fn_map=collate_fn_map)
  File "/usr/local/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 155, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 272, in collate_tensor_fn
    return torch.stack(batch, 0, out=out)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: stack expects each tensor to be equal size, but got [3, 298, 224] at entry 0 and [3, 224, 298] at entry 1

