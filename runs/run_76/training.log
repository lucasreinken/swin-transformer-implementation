2025-12-02 20:25:40,867 - INFO - Logging initialized. Log file: runs/run_76/training.log
2025-12-02 20:25:40,868 - INFO - Experiment directory: runs/run_76
2025-12-02 20:25:40,868 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-02 20:25:41,004 - INFO - Random seeds set to 42 (deterministic=False)
2025-12-02 20:25:41,005 - INFO - Using device: cuda
2025-12-02 20:25:41,005 - INFO - Training configuration: epochs=2, warmup=1, lr=0.0001
2025-12-02 20:25:41,006 - INFO - Loading dataset...
2025-12-02 20:25:41,007 - INFO - Starting ImageNet data loading from root: /mnt/datasets/imagenet/2012
2025-12-02 20:25:41,007 - INFO - Resolved root path: /mnt/datasets/imagenet/2012
2025-12-02 20:25:41,008 - INFO - Root path exists: True
2025-12-02 20:25:41,008 - INFO - Root path is dir: True
2025-12-02 20:25:41,009 - INFO - Contents of /mnt/datasets/imagenet/2012: ['/mnt/datasets/imagenet/2012/train_set_small', '/mnt/datasets/imagenet/2012/train_set', '/mnt/datasets/imagenet/2012/val_set_unlabeled', '/mnt/datasets/imagenet/2012/val_set', '/mnt/datasets/imagenet/2012/meta']
2025-12-02 20:25:41,009 - INFO - Loading ImageNet datasets using torchvision.ImageNet...
2025-12-02 20:25:41,173 - ERROR - Failed to load ImageNet with torchvision.ImageNet: The archive ILSVRC2012_devkit_t12.tar.gz is not present in the root directory or is corrupted. You need to download it externally and place it in /mnt/datasets/imagenet/2012.
2025-12-02 20:25:41,174 - INFO - Fallback: Expected train_dir: /mnt/datasets/imagenet/2012/train_set, exists: True
2025-12-02 20:25:41,175 - INFO - Fallback: Expected val_dir: /mnt/datasets/imagenet/2012/val_set, exists: True
2025-12-02 20:25:59,425 - INFO - Loaded ImageNet data (fallback) from /mnt/datasets/imagenet/2012: train=1281167, val=50000
2025-12-02 20:25:59,427 - INFO - Dataset loaded: train=8, val=1, test=1 batches
2025-12-02 20:26:01,086 - INFO - Training Swin-Base from scratch
2025-12-02 20:26:01,086 - INFO - Initializing model from scratch...
2025-12-02 20:26:01,087 - INFO - Model architecture: Swin-Base
2025-12-02 20:26:01,087 - INFO - Model config: embed_dim=128, depths=[2, 2, 18, 2], num_heads=[4, 8, 16, 32]
2025-12-02 20:26:02,348 - INFO - Model created with random initialization
2025-12-02 20:26:02,349 - INFO - Total parameters: 87,768,224
2025-12-02 20:26:02,350 - INFO - Trainable parameters: 87,768,224
2025-12-02 20:26:02,699 - INFO - Starting from-scratch training...
2025-12-02 20:26:02,700 - INFO - Optimizer: training all model parameters
2025-12-02 20:26:02,702 - INFO - Starting training...
2025-12-02 20:26:04,648 - ERROR - Experiment failed with error: stack expects each tensor to be equal size, but got [3, 224, 298] at entry 0 and [3, 224, 280] at entry 1
2025-12-02 20:26:04,649 - ERROR - Full traceback:
Traceback (most recent call last):
  File "/home/pml04/swin_transformer/Machine-Learning-Project/main.py", line 191, in main
    run_from_scratch(
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/pipelines/from_scratch.py", line 230, in run_from_scratch
    criterion, lr_history, metrics_history = _train_single_model(
                                             ^^^^^^^^^^^^^^^^^^^^
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/pipelines/from_scratch.py", line 130, in _train_single_model
    run_training_loop(
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/training/trainer.py", line 157, in run_training_loop
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/training/trainer.py", line 57, in train_one_epoch
    for batch_idx, (inputs, labels) in enumerate(train_loader):
                                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 398, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 212, in collate
    collate(samples, collate_fn_map=collate_fn_map)
  File "/usr/local/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 155, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 272, in collate_tensor_fn
    return torch.stack(batch, 0, out=out)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: stack expects each tensor to be equal size, but got [3, 224, 298] at entry 0 and [3, 224, 280] at entry 1
