2025-12-02 20:31:24,323 - INFO - Logging initialized. Log file: runs/run_77/training.log
2025-12-02 20:31:24,324 - INFO - Experiment directory: runs/run_77
2025-12-02 20:31:24,325 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-02 20:31:24,463 - INFO - Random seeds set to 42 (deterministic=False)
2025-12-02 20:31:24,463 - INFO - Using device: cuda
2025-12-02 20:31:24,464 - INFO - Training configuration: epochs=2, warmup=1, lr=0.0001
2025-12-02 20:31:24,464 - INFO - Loading dataset...
2025-12-02 20:31:24,466 - INFO - Starting ImageNet data loading from root: /mnt/datasets/imagenet/2012
2025-12-02 20:31:24,467 - INFO - Resolved root path: /mnt/datasets/imagenet/2012
2025-12-02 20:31:24,467 - INFO - Root path exists: True
2025-12-02 20:31:24,468 - INFO - Root path is dir: True
2025-12-02 20:31:24,469 - INFO - Contents of /mnt/datasets/imagenet/2012: ['/mnt/datasets/imagenet/2012/train_set_small', '/mnt/datasets/imagenet/2012/train_set', '/mnt/datasets/imagenet/2012/val_set_unlabeled', '/mnt/datasets/imagenet/2012/val_set', '/mnt/datasets/imagenet/2012/meta']
2025-12-02 20:31:24,469 - INFO - Loading ImageNet datasets using torchvision.ImageNet...
2025-12-02 20:31:24,632 - ERROR - Failed to load ImageNet with torchvision.ImageNet: The archive ILSVRC2012_devkit_t12.tar.gz is not present in the root directory or is corrupted. You need to download it externally and place it in /mnt/datasets/imagenet/2012.
2025-12-02 20:31:24,633 - INFO - Fallback: Expected train_dir: /mnt/datasets/imagenet/2012/train_set, exists: True
2025-12-02 20:31:24,634 - INFO - Fallback: Expected val_dir: /mnt/datasets/imagenet/2012/val_set, exists: True
2025-12-02 20:31:43,383 - INFO - Loaded ImageNet data (fallback) from /mnt/datasets/imagenet/2012: train=1281167, val=50000
2025-12-02 20:31:43,385 - INFO - Dataset loaded: train=8, val=1, test=1 batches
2025-12-02 20:31:45,024 - INFO - Training Swin-Base from scratch
2025-12-02 20:31:45,025 - INFO - Initializing model from scratch...
2025-12-02 20:31:45,025 - INFO - Model architecture: Swin-Base
2025-12-02 20:31:45,026 - INFO - Model config: embed_dim=128, depths=[2, 2, 18, 2], num_heads=[4, 8, 16, 32]
2025-12-02 20:31:46,292 - INFO - Model created with random initialization
2025-12-02 20:31:46,293 - INFO - Total parameters: 87,768,224
2025-12-02 20:31:46,293 - INFO - Trainable parameters: 87,768,224
2025-12-02 20:31:46,656 - INFO - Starting from-scratch training...
2025-12-02 20:31:46,656 - INFO - Optimizer: training all model parameters
2025-12-02 20:31:46,658 - INFO - Starting training...
2025-12-02 20:32:24,464 - INFO - Epoch 1/2: LR: 0.000100
2025-12-02 20:32:24,465 - INFO - Epoch 1/2: Train Loss: 2.8778, Val Loss: 4.8205, Val Acc: 50.00%
2025-12-02 20:32:55,074 - INFO - Epoch 2/2: LR: 0.000000
2025-12-02 20:32:55,075 - INFO - Epoch 2/2: Train Loss: 0.0173, Val Loss: 8.7352, Val Acc: 50.00%
2025-12-02 20:32:55,076 - INFO - Training completed!
2025-12-02 20:32:55,078 - INFO - Training completed!
2025-12-02 20:32:55,079 - INFO - Generating training curves...
2025-12-02 20:32:56,337 - ERROR - Experiment failed with error: index 2 is out of bounds for axis 1 with size 2
2025-12-02 20:32:56,338 - ERROR - Full traceback:
Traceback (most recent call last):
  File "/home/pml04/swin_transformer/Machine-Learning-Project/main.py", line 201, in main
    run_from_scratch(
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/pipelines/from_scratch.py", line 246, in run_from_scratch
    final_metrics = _finalize_training(
                    ^^^^^^^^^^^^^^^^^^^
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/pipelines/from_scratch.py", line 164, in _finalize_training
    final_test_metrics = generate_reports(
                         ^^^^^^^^^^^^^^^^^
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/pipelines/utils.py", line 143, in generate_reports
    plot_training_curves(
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/training/metrics.py", line 248, in plot_training_curves
    plot_per_class_f1_curves(epochs, metrics_history, base_path, figsize)
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/training/metrics.py", line 216, in plot_per_class_f1_curves
    plt.plot(epochs, f1_per_class[:, i], label=class_name, linewidth=2)
                     ~~~~~~~~~~~~^^^^^^
IndexError: index 2 is out of bounds for axis 1 with size 2
