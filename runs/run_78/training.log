2025-12-02 20:35:15,097 - INFO - Logging initialized. Log file: runs/run_78/training.log
2025-12-02 20:35:15,098 - INFO - Experiment directory: runs/run_78
2025-12-02 20:35:15,098 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-02 20:35:15,242 - INFO - Random seeds set to 42 (deterministic=False)
2025-12-02 20:35:15,243 - INFO - Using device: cuda
2025-12-02 20:35:15,244 - INFO - Training configuration: epochs=2, warmup=1, lr=0.0001
2025-12-02 20:35:15,244 - INFO - Loading dataset...
2025-12-02 20:35:15,246 - INFO - Starting ImageNet data loading from root: /mnt/datasets/imagenet/2012
2025-12-02 20:35:15,246 - INFO - Resolved root path: /mnt/datasets/imagenet/2012
2025-12-02 20:35:15,247 - INFO - Root path exists: True
2025-12-02 20:35:15,248 - INFO - Root path is dir: True
2025-12-02 20:35:15,248 - INFO - Contents of /mnt/datasets/imagenet/2012: ['/mnt/datasets/imagenet/2012/train_set_small', '/mnt/datasets/imagenet/2012/train_set', '/mnt/datasets/imagenet/2012/val_set_unlabeled', '/mnt/datasets/imagenet/2012/val_set', '/mnt/datasets/imagenet/2012/meta']
2025-12-02 20:35:15,249 - INFO - Loading ImageNet datasets using torchvision.ImageNet...
2025-12-02 20:35:15,423 - ERROR - Failed to load ImageNet with torchvision.ImageNet: The archive ILSVRC2012_devkit_t12.tar.gz is not present in the root directory or is corrupted. You need to download it externally and place it in /mnt/datasets/imagenet/2012.
2025-12-02 20:35:15,424 - INFO - Fallback: Expected train_dir: /mnt/datasets/imagenet/2012/train_set, exists: True
2025-12-02 20:35:15,424 - INFO - Fallback: Expected val_dir: /mnt/datasets/imagenet/2012/val_set, exists: True
2025-12-02 20:35:33,987 - INFO - Loaded ImageNet data (fallback) from /mnt/datasets/imagenet/2012: train=1281167, val=50000
2025-12-02 20:35:33,988 - INFO - Dataset loaded: train=8, val=1, test=1 batches
2025-12-02 20:35:35,705 - INFO - Training Swin-Base from scratch
2025-12-02 20:35:35,705 - INFO - Initializing model from scratch...
2025-12-02 20:35:35,706 - INFO - Model architecture: Swin-Base
2025-12-02 20:35:35,706 - INFO - Model config: embed_dim=128, depths=[2, 2, 18, 2], num_heads=[4, 8, 16, 32]
2025-12-02 20:35:36,973 - INFO - Model created with random initialization
2025-12-02 20:35:36,974 - INFO - Total parameters: 87,768,224
2025-12-02 20:35:36,975 - INFO - Trainable parameters: 87,768,224
2025-12-02 20:35:37,335 - INFO - Starting from-scratch training...
2025-12-02 20:35:37,336 - INFO - Optimizer: training all model parameters
2025-12-02 20:35:37,338 - INFO - Starting training...
2025-12-02 20:36:09,712 - INFO - Epoch 1/2: LR: 0.000100
2025-12-02 20:36:09,713 - INFO - Epoch 1/2: Train Loss: 2.8778, Val Loss: 4.8205, Val Acc: 50.00%
2025-12-02 20:36:40,495 - INFO - Epoch 2/2: LR: 0.000000
2025-12-02 20:36:40,495 - INFO - Epoch 2/2: Train Loss: 0.0173, Val Loss: 8.7352, Val Acc: 50.00%
2025-12-02 20:36:40,496 - INFO - Training completed!
2025-12-02 20:36:40,497 - INFO - Training completed!
2025-12-02 20:36:40,498 - INFO - Generating training curves...
2025-12-02 20:36:42,073 - INFO - Training curves saved as separate images with base name 'runs/run_78/training_curves_from_scratch'
2025-12-02 20:36:42,073 - INFO - Generating confusion matrix on test set...
2025-12-02 20:36:57,147 - INFO - Performing final evaluation of from_scratch model on test set...
2025-12-02 20:36:59,757 - INFO - Final Test Results of from_scratch model: Loss: 8.7352, Accuracy: 50.00%
2025-12-02 20:36:59,758 - INFO - Generating LR schedule plot of from_scratch model...
2025-12-02 20:37:00,087 - INFO - LR schedule plot saved to 'runs/run_78/lr_schedule_from_scratch.png'
2025-12-02 20:37:00,088 - INFO - 
Final Test Results:
2025-12-02 20:37:00,088 - INFO - Loss: 8.7352
2025-12-02 20:37:00,088 - INFO - Accuracy: 50.00%
2025-12-02 20:37:00,089 - INFO - Precision: 25.00%
2025-12-02 20:37:00,089 - INFO - Recall: 50.00%
2025-12-02 20:37:00,090 - INFO - F1 Score: 33.33%
2025-12-02 20:37:00,094 - INFO - Experiment completed. Results saved to runs/run_78/results_from_scratch.json
2025-12-02 20:37:00,115 - INFO - Experiment completed. Metadata saved to runs/run_78/metadata_from_scratch.json
2025-12-02 20:37:00,778 - INFO - âœ… Model weights saved: runs/run_78/final_model_from_scratch_weights.pth
2025-12-02 20:37:00,782 - INFO - Final model saved: runs/run_78/final_model_from_scratch_weights.pth
2025-12-02 20:37:00,782 - INFO - Final model metadata saved: runs/run_78/final_model_from_scratch_metadata.json
2025-12-02 20:37:00,783 - INFO - === FROM-SCRATCH RESULTS (IMAGENET) ===
2025-12-02 20:37:00,783 - INFO - Final Accuracy: 50.00%
2025-12-02 20:37:00,784 - INFO - Final F1 Score: 33.33%
2025-12-02 20:37:00,786 - INFO - from_scratch experiment completed successfully!
