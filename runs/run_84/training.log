2025-12-02 21:32:28,279 - INFO - Logging initialized. Log file: runs/run_84/training.log
2025-12-02 21:32:28,279 - INFO - Experiment directory: runs/run_84
2025-12-02 21:32:28,280 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-02 21:32:28,408 - INFO - Random seeds set to 42 (deterministic=False)
2025-12-02 21:32:28,409 - INFO - Using device: cuda
2025-12-02 21:32:28,409 - INFO - Training configuration: epochs=2, warmup=1, lr=0.0001
2025-12-02 21:32:28,409 - INFO - Loading dataset...
2025-12-02 21:32:28,410 - INFO - Starting ImageNet data loading from root: /
2025-12-02 21:32:28,410 - INFO - Resolved root path: /
2025-12-02 21:32:28,411 - INFO - Root path exists: True
2025-12-02 21:32:28,411 - INFO - Root path is dir: True
2025-12-02 21:32:28,414 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var', '/meta', '/train_set', '/train_set_small', '/val_set', '/val_set_unlabeled']
2025-12-02 21:32:28,414 - INFO - Loading ImageNet datasets using torchvision.ImageNet...
2025-12-02 21:32:28,564 - ERROR - Failed to load ImageNet with torchvision.ImageNet: The archive ILSVRC2012_devkit_t12.tar.gz is not present in the root directory or is corrupted. You need to download it externally and place it in /.
2025-12-02 21:32:28,565 - INFO - Fallback: Expected train_dir: /train_set, exists: True
2025-12-02 21:32:28,565 - INFO - Fallback: Expected val_dir: /val_set, exists: True
2025-12-02 21:32:34,707 - INFO - Loaded ImageNet data (fallback) from /: train=1281167, val=50000
2025-12-02 21:32:34,708 - INFO - Dataset loaded: train=5000 samples (40 batches), val=500 samples (4 batches), test=500 samples (4 batches)
2025-12-02 21:32:36,247 - INFO - Training Swin-Tiny from scratch
2025-12-02 21:32:36,247 - INFO - Initializing model from scratch...
2025-12-02 21:32:36,248 - INFO - Model architecture: Swin-Tiny
2025-12-02 21:32:36,248 - INFO - Model config: embed_dim=96, depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24]
2025-12-02 21:32:36,748 - INFO - Model created with random initialization
2025-12-02 21:32:36,748 - INFO - Total parameters: 28,288,354
2025-12-02 21:32:36,748 - INFO - Trainable parameters: 28,288,354
2025-12-02 21:32:37,049 - INFO - Starting from-scratch training...
2025-12-02 21:32:37,049 - INFO - Optimizer: training all model parameters
2025-12-02 21:32:37,050 - INFO - Starting training...
2025-12-02 21:34:16,308 - INFO - Epoch 1/2: LR: 0.000100
2025-12-02 21:34:16,309 - INFO - Epoch 1/2: Train Loss: 2.9251, Val Loss: 6.0188, Val Acc: 22.80%
2025-12-02 21:35:37,636 - INFO - Epoch 2/2: LR: 0.000000
2025-12-02 21:35:37,637 - INFO - Epoch 2/2: Train Loss: 1.1155, Val Loss: 7.3951, Val Acc: 22.00%
2025-12-02 21:35:37,637 - INFO - Training completed!
2025-12-02 21:35:37,638 - INFO - Training completed!
2025-12-02 21:35:37,639 - INFO - Generating training curves...
2025-12-02 21:35:39,471 - INFO - Training curves saved as separate images with base name 'runs/run_84/training_curves_from_scratch'
2025-12-02 21:35:39,472 - INFO - Generating confusion matrix on test set...
2025-12-02 21:36:00,442 - INFO - Performing final evaluation of from_scratch model on test set...
2025-12-02 21:36:08,664 - INFO - Final Test Results of from_scratch model: Loss: 7.3951, Accuracy: 22.00%
2025-12-02 21:36:08,665 - INFO - Generating LR schedule plot of from_scratch model...
2025-12-02 21:36:08,999 - INFO - LR schedule plot saved to 'runs/run_84/lr_schedule_from_scratch.png'
2025-12-02 21:36:08,999 - INFO - 
Final Test Results:
2025-12-02 21:36:09,000 - INFO - Loss: 7.3951
2025-12-02 21:36:09,000 - INFO - Accuracy: 22.00%
2025-12-02 21:36:09,001 - INFO - Precision: 11.12%
2025-12-02 21:36:09,001 - INFO - Recall: 22.00%
2025-12-02 21:36:09,002 - INFO - F1 Score: 11.54%
2025-12-02 21:36:09,007 - INFO - Experiment completed. Results saved to runs/run_84/results_from_scratch.json
2025-12-02 21:36:09,009 - INFO - Experiment completed. Metadata saved to runs/run_84/metadata_from_scratch.json
2025-12-02 21:36:09,258 - INFO - âœ… Model weights saved: runs/run_84/final_model_from_scratch_weights.pth
2025-12-02 21:36:09,260 - INFO - Final model saved: runs/run_84/final_model_from_scratch_weights.pth
2025-12-02 21:36:09,260 - INFO - Final model metadata saved: runs/run_84/final_model_from_scratch_metadata.json
2025-12-02 21:36:09,260 - INFO - === FROM-SCRATCH RESULTS (IMAGENET) ===
2025-12-02 21:36:09,261 - INFO - Final Accuracy: 22.00%
2025-12-02 21:36:09,261 - INFO - Final F1 Score: 11.54%
2025-12-02 21:36:09,262 - INFO - from_scratch experiment completed successfully!
