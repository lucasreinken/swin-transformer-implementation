2025-12-02 21:44:03,669 - INFO - Logging initialized. Log file: runs/run_85/training.log
2025-12-02 21:44:03,728 - INFO - Experiment directory: runs/run_85
2025-12-02 21:44:03,729 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-02 21:44:03,864 - INFO - Random seeds set to 42 (deterministic=False)
2025-12-02 21:44:03,864 - INFO - Using device: cuda
2025-12-02 21:44:03,865 - INFO - Training configuration: epochs=2, warmup=1, lr=0.0001
2025-12-02 21:44:03,865 - INFO - Loading dataset...
2025-12-02 21:44:03,866 - INFO - Starting ImageNet data loading from root: /
2025-12-02 21:44:03,866 - INFO - Resolved root path: /
2025-12-02 21:44:03,866 - INFO - Root path exists: True
2025-12-02 21:44:03,867 - INFO - Root path is dir: True
2025-12-02 21:44:03,870 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var', '/meta', '/train_set', '/train_set_small', '/val_set', '/val_set_unlabeled']
2025-12-02 21:44:03,870 - INFO - Expected train_dir: /train_set, exists: True
2025-12-02 21:44:03,871 - INFO - Expected val_dir: /val_set, exists: True
2025-12-02 21:44:09,470 - INFO - Loaded ImageNet data from /: train=1281167, val=50000
2025-12-02 21:44:09,471 - INFO - Dataset loaded: train=5000 samples (40 batches), val=500 samples (4 batches), test=500 samples (4 batches)
2025-12-02 21:44:11,281 - INFO - Training Swin-Tiny from scratch
2025-12-02 21:44:11,282 - INFO - Initializing model from scratch...
2025-12-02 21:44:11,282 - INFO - Model architecture: Swin-Tiny
2025-12-02 21:44:11,282 - INFO - Model config: embed_dim=96, depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24]
2025-12-02 21:44:11,810 - INFO - Model created with random initialization
2025-12-02 21:44:11,811 - INFO - Total parameters: 28,288,354
2025-12-02 21:44:11,811 - INFO - Trainable parameters: 28,288,354
2025-12-02 21:44:12,118 - INFO - Starting from-scratch training...
2025-12-02 21:44:12,119 - INFO - Optimizer: training all model parameters
2025-12-02 21:44:12,120 - INFO - Starting training...
2025-12-02 21:45:38,015 - INFO - Epoch 1/2: LR: 0.000100
2025-12-02 21:45:38,016 - INFO - Epoch 1/2: Train Loss: 2.9251, Val Loss: 6.0188, Val Acc: 22.80%
2025-12-02 21:46:59,151 - INFO - Epoch 2/2: LR: 0.000000
2025-12-02 21:46:59,152 - INFO - Epoch 2/2: Train Loss: 1.1155, Val Loss: 7.3951, Val Acc: 22.00%
2025-12-02 21:46:59,152 - INFO - Training completed!
2025-12-02 21:46:59,154 - INFO - Training completed!
2025-12-02 21:46:59,154 - INFO - Generating training curves...
2025-12-02 21:47:01,182 - INFO - Training curves saved as separate images with base name 'runs/run_85/training_curves_from_scratch'
2025-12-02 21:47:01,183 - INFO - Generating confusion matrix on test set...
2025-12-02 21:47:22,004 - INFO - Performing final evaluation of from_scratch model on test set...
2025-12-02 21:47:30,200 - INFO - Final Test Results of from_scratch model: Loss: 7.3951, Accuracy: 22.00%
2025-12-02 21:47:30,200 - INFO - Generating LR schedule plot of from_scratch model...
2025-12-02 21:47:30,531 - INFO - LR schedule plot saved to 'runs/run_85/lr_schedule_from_scratch.png'
2025-12-02 21:47:30,532 - INFO - 
Final Test Results:
2025-12-02 21:47:30,532 - INFO - Loss: 7.3951
2025-12-02 21:47:30,533 - INFO - Accuracy: 22.00%
2025-12-02 21:47:30,533 - INFO - Precision: 11.12%
2025-12-02 21:47:30,533 - INFO - Recall: 22.00%
2025-12-02 21:47:30,534 - INFO - F1 Score: 11.54%
2025-12-02 21:47:30,539 - INFO - Experiment completed. Results saved to runs/run_85/results_from_scratch.json
2025-12-02 21:47:30,541 - INFO - Experiment completed. Metadata saved to runs/run_85/metadata_from_scratch.json
2025-12-02 21:47:30,776 - INFO - âœ… Model weights saved: runs/run_85/final_model_from_scratch_weights.pth
2025-12-02 21:47:30,778 - INFO - Final model saved: runs/run_85/final_model_from_scratch_weights.pth
2025-12-02 21:47:30,778 - INFO - Final model metadata saved: runs/run_85/final_model_from_scratch_metadata.json
2025-12-02 21:47:30,779 - INFO - === FROM-SCRATCH RESULTS (IMAGENET) ===
2025-12-02 21:47:30,779 - INFO - Final Accuracy: 22.00%
2025-12-02 21:47:30,779 - INFO - Final F1 Score: 11.54%
2025-12-02 21:47:30,781 - INFO - from_scratch experiment completed successfully!
