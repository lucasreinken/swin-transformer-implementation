2025-12-02 21:48:33,452 - INFO - Logging initialized. Log file: runs/run_86/training.log
2025-12-02 21:48:33,481 - INFO - Experiment directory: runs/run_86
2025-12-02 21:48:33,481 - INFO - Setting random seeds for reproducibility (seed: 42)...
2025-12-02 21:48:33,620 - INFO - Random seeds set to 42 (deterministic=False)
2025-12-02 21:48:33,620 - INFO - Using device: cuda
2025-12-02 21:48:33,620 - INFO - Training configuration: epochs=2, warmup=1, lr=0.0001
2025-12-02 21:48:33,621 - INFO - Loading dataset...
2025-12-02 21:48:33,623 - INFO - Starting ImageNet data loading from root: /
2025-12-02 21:48:33,623 - INFO - Resolved root path: /
2025-12-02 21:48:33,624 - INFO - Root path exists: True
2025-12-02 21:48:33,624 - INFO - Root path is dir: True
2025-12-02 21:48:33,627 - INFO - Contents of /: ['/.exec', '/.run', '/.shell', '/.singularity.d', '/.test', '/bin', '/boot', '/dev', '/environment', '/etc', '/home', '/lib', '/lib64', '/media', '/mnt', '/opt', '/proc', '/requirements.txt', '/root', '/run', '/sbin', '/singularity', '/srv', '/sys', '/tmp', '/usr', '/var', '/meta', '/train_set', '/train_set_small', '/val_set', '/val_set_unlabeled']
2025-12-02 21:48:33,628 - INFO - Expected train_dir: /train_set, exists: True
2025-12-02 21:48:33,628 - INFO - Expected val_dir: /val_set, exists: True
2025-12-02 21:48:39,372 - INFO - Loaded ImageNet data from /: train=1281167, val=50000
2025-12-02 21:48:39,373 - INFO - Dataset loaded: train=5000 samples (40 batches), val=500 samples (4 batches), test=500 samples (4 batches)
2025-12-02 21:48:41,165 - INFO - Using pretrained model: swin_tiny_patch4_window7_224
2025-12-02 21:48:41,165 - INFO - Model architecture: Swin-Tiny
2025-12-02 21:48:41,165 - INFO - Initializing reference model...
2025-12-02 21:48:41,166 - INFO - Loading TIMM model: swin_tiny_patch4_window7_224 with pretrained weights
2025-12-02 21:48:41,702 - INFO - Loading pretrained weights from Hugging Face hub (timm/swin_tiny_patch4_window7_224.ms_in1k)
2025-12-02 21:48:41,932 - INFO - HTTP Request: HEAD https://huggingface.co/timm/swin_tiny_patch4_window7_224.ms_in1k/resolve/main/model.safetensors "HTTP/1.1 302 Found"
2025-12-02 21:48:41,937 - INFO - [timm/swin_tiny_patch4_window7_224.ms_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-12-02 21:48:41,974 - INFO - Successfully loaded swin_tiny_patch4_window7_224 from TIMM
2025-12-02 21:48:41,974 - INFO - Encoder loaded: 768 output features
2025-12-02 21:48:41,979 - INFO - Created classification head: 768 -> 1000 classes
2025-12-02 21:48:41,980 - INFO - Reference model created. Trainable params (head only): 770,536
2025-12-02 21:48:42,263 - INFO - Detected Swin Transformer architecture
2025-12-02 21:48:42,264 - INFO - Detected model size: tiny
2025-12-02 21:48:42,265 - INFO - Initializing custom Swin model (size: tiny)...
2025-12-02 21:48:42,265 - INFO - Custom model will match architecture: embed_dim=96, depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24]
2025-12-02 21:48:42,624 - INFO - Transferring weights from reference to custom encoder...
2025-12-02 21:48:42,625 - INFO - Weight transfer: SwinTransformer -> SwinTransformerModel
2025-12-02 21:48:42,637 - INFO - Weight transfer: 169 layers transferred.
2025-12-02 21:48:42,662 - INFO - Weight transfer completed: {'transferred': 169, 'missing': 0, 'size_mismatches': 0}
2025-12-02 21:48:42,662 - INFO - âœ“ All expected weights transferred successfully
2025-12-02 21:48:42,663 - INFO - Custom model created. Trainable params (head only): 770,536
2025-12-02 21:48:42,665 - INFO - Starting reference model training...
2025-12-02 21:48:42,666 - INFO - Optimizer: training head parameters only (encoder frozen)
2025-12-02 21:48:42,666 - INFO - Starting training...
2025-12-02 21:49:46,609 - INFO - Epoch 1/2: LR: 0.000100
2025-12-02 21:49:46,609 - INFO - Epoch 1/2: Train Loss: 6.4685, Val Loss: 6.7731, Val Acc: 0.00%
2025-12-02 21:50:46,191 - INFO - Epoch 2/2: LR: 0.000000
2025-12-02 21:50:46,192 - INFO - Epoch 2/2: Train Loss: 5.8736, Val Loss: 6.3383, Val Acc: 20.20%
2025-12-02 21:50:46,193 - INFO - Training completed!
2025-12-02 21:50:46,193 - INFO - Reference model training completed!
2025-12-02 21:50:46,194 - INFO - Generating training curves...
2025-12-02 21:50:47,722 - ERROR - Experiment failed with error: setting an array element with a sequence. The requested array has an inhomogeneous shape after 1 dimensions. The detected shape was (2,) + inhomogeneous part.
2025-12-02 21:50:47,723 - ERROR - Full traceback:
Traceback (most recent call last):
  File "/home/pml04/swin_transformer/Machine-Learning-Project/main.py", line 190, in main
    run_linear_probing(
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/pipelines/linear_probing.py", line 389, in run_linear_probing
    final_reference_metrics = _finalize_validation(
                              ^^^^^^^^^^^^^^^^^^^^^
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/pipelines/linear_probing.py", line 294, in _finalize_validation
    final_test_metrics = generate_reports(
                         ^^^^^^^^^^^^^^^^^
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/pipelines/utils.py", line 143, in generate_reports
    plot_training_curves(
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/training/metrics.py", line 262, in plot_training_curves
    plot_per_class_f1_curves(epochs, metrics_history, base_path, figsize)
  File "/home/pml04/swin_transformer/Machine-Learning-Project/src/training/metrics.py", line 202, in plot_per_class_f1_curves
    f1_per_class = np.array(metrics_history["val_f1_per_class"])
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: setting an array element with a sequence. The requested array has an inhomogeneous shape after 1 dimensions. The detected shape was (2,) + inhomogeneous part.
